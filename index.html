<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"180.76.50.251","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"right","display":"always","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="是很菜的人的很菜的博客捏，无栈工程学徒ing。">
<meta property="og:type" content="website">
<meta property="og:title" content="MAL&#39;S_BLOG">
<meta property="og:url" content="http://180.76.50.251/index.html">
<meta property="og:site_name" content="MAL&#39;S_BLOG">
<meta property="og:description" content="是很菜的人的很菜的博客捏，无栈工程学徒ing。">
<meta property="og:locale">
<meta property="article:author" content="MALossov">
<meta property="article:tag" content="菜">
<meta property="article:tag" content="胡搞瞎搞">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://180.76.50.251/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-Hans'
  };
</script>

  <title>MAL'S_BLOG</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">MAL'S_BLOG</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Welcome to Malossov's Personal Archieve!</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-主页">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>主页</a>

  </li>
        <li class="menu-item menu-item-标签">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-分类">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-归档">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-友链">

    <a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>友链</a>

  </li>

    <li> <a title="把这个链接拖到你的Chrome收藏夹工具栏中" href='javascript:(function() {
    function c() {
        var e = document.createElement("link");
        e.setAttribute("type", "text/css");
        e.setAttribute("rel", "stylesheet");
        e.setAttribute("href", f);
        e.setAttribute("class", l);
        document.body.appendChild(e)
    }

    function h() {
        var e = document.getElementsByClassName(l);
        for (var t = 0; t < e.length; t++) {
            document.body.removeChild(e[t])
        }
    }

    function p() {
        var e = document.createElement("div");
        e.setAttribute("class", a);
        document.body.appendChild(e);
        setTimeout(function() {
            document.body.removeChild(e)
        }, 100)
    }

    function d(e) {
        return {
            height : e.offsetHeight,
            width : e.offsetWidth
        }
    }

    function v(i) {
        var s = d(i);
        return s.height > e && s.height < n && s.width > t && s.width < r
    }

    function m(e) {
        var t = e;
        var n = 0;
        while (!!t) {
            n += t.offsetTop;
            t = t.offsetParent
        }
        return n
    }

    function g() {
        var e = document.documentElement;
        if (!!window.innerWidth) {
            return window.innerHeight
        } else if (e && !isNaN(e.clientHeight)) {
            return e.clientHeight
        }
        return 0
    }

    function y() {
        if (window.pageYOffset) {
            return window.pageYOffset
        }
        return Math.max(document.documentElement.scrollTop, document.body.scrollTop)
    }

    function E(e) {
        var t = m(e);
        return t >= w && t <= b + w
    }

    function S() {
        var e = document.createElement("audio");
        e.setAttribute("class", l);
        e.src = i;
        e.loop = false;
        e.addEventListener("canplay", function() {
            setTimeout(function() {
                x(k)
            }, 500);
            setTimeout(function() {
                N();
                p();
                for (var e = 0; e < O.length; e++) {
                    T(O[e])
                }
            }, 15500)
        }, true);
        e.addEventListener("ended", function() {
            N();
            h()
        }, true);
        e.innerHTML = " <p>If you are reading this, it is because your browser does not support the audio element. We recommend that you get a new browser.</p> <p>";
        document.body.appendChild(e);
        e.play()
    }

    function x(e) {
        e.className += " " + s + " " + o
    }

    function T(e) {
        e.className += " " + s + " " + u[Math.floor(Math.random() * u.length)]
    }

    function N() {
        var e = document.getElementsByClassName(s);
        var t = new RegExp("\\b" + s + "\\b");
        for (var n = 0; n < e.length; ) {
            e[n].className = e[n].className.replace(t, "")
        }
    }

    var e = 30;
    var t = 30;
    var n = 350;
    var r = 350;
    var i = "//7xuupy.com1.z0.glb.clouddn.com/tongxingSibel%20-%20Im%20Sorry.mp3";
    var s = "mw-harlem_shake_me";
    var o = "im_first";
    var u = ["im_drunk", "im_baked", "im_trippin", "im_blown"];
    var a = "mw-strobe_light";
    var f = "//s3.amazonaws.com/moovweb-marketing/playground/harlem-shake-style.css";
    var l = "mw_added_css";
    var b = g();
    var w = y();
    var C = document.getElementsByTagName("*");
    var k = null;
    for (var L = 0; L < C.length; L++) {
        var A = C[L];
        if (v(A)) {
            if (E(A)) {
                k = A;
                break
            }
        }
    }
    if (A === null) {
        console.warn("Could not find a node of the right size. Please try a different page.");
        return
    }
    c();
    S();
    var O = [];
    for (var L = 0; L < C.length; L++) {
        var A = C[L];
        if (v(A)) {
            O.push(A)
        }
    }
    })()    '>High一下</a> </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://180.76.50.251/2022/07/16/ProgramLearn/Embed/%E6%9A%91%E5%81%87%E7%AC%AC%E4%BA%8C%E6%AC%A1%E8%AE%AD%E7%BB%83%E9%A2%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avator.png">
      <meta itemprop="name" content="MALossov">
      <meta itemprop="description" content="是很菜的人的很菜的博客捏，无栈工程学徒ing。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MAL'S_BLOG">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/07/16/ProgramLearn/Embed/%E6%9A%91%E5%81%87%E7%AC%AC%E4%BA%8C%E6%AC%A1%E8%AE%AD%E7%BB%83%E9%A2%98/" class="post-title-link" itemprop="url">暑假第二次训练题最终报告</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2022-07-16 18:00:53 / Modified: 22:00:26" itemprop="dateCreated datePublished" datetime="2022-07-16T18:00:53+08:00">2022-07-16</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%A1%AC%E4%BB%B6/" itemprop="url" rel="index"><span itemprop="name">硬件</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="一、系统方案"><a href="#一、系统方案" class="headerlink" title="一、系统方案"></a>一、系统方案</h2><h3 id="1-1-方案的比较与选择"><a href="#1-1-方案的比较与选择" class="headerlink" title="1.1  方案的比较与选择"></a>1.1  方案的比较与选择</h3><h4 id="1-取样电阻接入方法的选择"><a href="#1-取样电阻接入方法的选择" class="headerlink" title="(1) 取样电阻接入方法的选择"></a>(1) 取样电阻接入方法的选择</h4><h5 id="i-使用模拟开关进行接入切换"><a href="#i-使用模拟开关进行接入切换" class="headerlink" title="i. 使用模拟开关进行接入切换"></a>i. 使用模拟开关进行接入切换</h5><p><strong>优点：</strong> 可以做到一路输入控制多路输出，有集成芯片，体积、发热较小。</p>
<p><strong>缺点：</strong> 只能应对电细微变化而且没有电平差别的场景，同时自身带有阻抗，通入高频时输出响应变化难以通过计算得到平衡，尤其是在相位特征上。</p>
<h5 id="ii-使用继电器进行接入切换"><a href="#ii-使用继电器进行接入切换" class="headerlink" title="ii.使用继电器进行接入切换"></a>ii.使用继电器进行接入切换</h5><p><strong>优点：</strong> 带载能力达，没有触点，寿命长，不受使用环境限制。</p>
<p><strong>缺点：</strong> 控制电流不能太大，仅能分出两路电流，由于是电磁结构，无法做到高频切换。</p>
<p><strong>总结</strong>：由于本题中，通过取样电阻和电路的电流为频率可能较高的直流、交流混合信号，如果采用模拟开关，可能会产生额外阻抗，不利于输入、输出电阻的系统计算。同时，该系统中，通过取样电阻的电流较小，使用继电器可以满足需求。</p>
<h4 id="2-处理器方案的选择"><a href="#2-处理器方案的选择" class="headerlink" title="(2)  处理器方案的选择"></a>(2)  处理器方案的选择</h4><h5 id="i-使用STM32F1系列MCU"><a href="#i-使用STM32F1系列MCU" class="headerlink" title="i.使用STM32F1系列MCU"></a>i.使用STM32F1系列MCU</h5><p><strong>优点：</strong> 价格便宜，参考资料众多，编程方便。多次使用，外设熟悉。</p>
<p><strong>缺点：</strong> 主频不高，ADC采样频率不高。对于DSP相关数学计算支持较差，仅有汇编FFT库可以使用，如果使用滤波器和加窗函数无法较好支持。同时片上SRAM较小，可能会因为加入大数组的原因导致内存溢出。</p>
<h5 id="ii-使用STM32H7系列产品线"><a href="#ii-使用STM32H7系列产品线" class="headerlink" title="ii.使用STM32H7系列产品线"></a>ii.使用STM32H7系列产品线</h5><p><strong>优点：</strong> 主频较高，片上资源多，内核支持ARM的DSP库，可以进行复杂的矩阵、滤波器、开方求模运算。</p>
<p><strong>缺点：</strong> 资料较少，内核提升带来的结果为编程复杂度的提升，同时参考资料较少而且价格昂贵。</p>
<p><strong>结论：</strong> 本题中，要求进行扫频来求幅频特性，如果不使用较为简单粗暴的峰峰值方法计算电压幅度，则可能在扫频频率较高时<strong>STM32F1</strong> 的ADC的计算功能无法跟上采样节奏，同时在本题基础上，如果出现更高难度指标，必定要用到FFT，在这次训练题中进行提前的准备。</p>
<h4 id="3-模数转换器的选择"><a href="#3-模数转换器的选择" class="headerlink" title="(3)  模数转换器的选择"></a>(3)  模数转换器的选择</h4><h5 id="i-使用片外ADC采样"><a href="#i-使用片外ADC采样" class="headerlink" title="i.使用片外ADC采样"></a>i.使用片外ADC采样</h5><h6 id="a-使用ADS1256"><a href="#a-使用ADS1256" class="headerlink" title="a)使用ADS1256"></a>a)使用ADS1256</h6><p><strong>优点：</strong> 1256精度较高。</p>
<p><strong>缺点：</strong> 采样速率较低，无法同步采样。同时1256的校准较为困难，气温、电压不一样将导致电压下降。同时可测范围由于打开<em>Buffer</em>的影响而和片内采样范围一致。同时可采频率选择范围较窄，仅能够达到30Kps。</p>
<h6 id="b-使用AD7606"><a href="#b-使用AD7606" class="headerlink" title="b)使用AD7606"></a>b)使用AD7606</h6><p><strong>优点：</strong> 同步采样。</p>
<p><strong>缺点：</strong> 采样速率依旧无法满足扫频判断指标需要的500kps，最高位200kps。并且之前未使用过该模块，使用该模块的学习和时间成本均较大。</p>
<h5 id="ii-使用片上ADC采样"><a href="#ii-使用片上ADC采样" class="headerlink" title="ii.使用片上ADC采样"></a>ii.使用片上ADC采样</h5><p><strong>优点：</strong> 驱动容易，可以轻松的读入DMA。</p>
<p><strong>缺点</strong>：如上所述，我们采用的STM32H7B0作为MCU，使用的16Bit-SAR型ADC，这种ADC的结构不同于Σ-δ型，真实分辨率并未达到16位，而是仅仅为14位左右。同时，如果使用STM32进行同步采样，则不得不面对出现<em>假同步</em>的情况，在采样率为500kps的时候，其同幅误差可能达到16°。</p>
<p><strong>总结：</strong> 使用STM32H7的片上ADC，其拥有最高可达2M的高采样率和可以通过过采样达到的16位精度，同时其<em>假同步</em>的缺陷可以通过手动算相得到修正，也不会影响幅值的计算。</p>
<h3 id="1-2-方案描述"><a href="#1-2-方案描述" class="headerlink" title="1.2 方案描述"></a>1.2 方案描述</h3><p><strong>综上所述，</strong> 在本题中，我们采用继电器控制取样电阻的接入，利用DDS产生基波后经过衰减器衰减到一个合适的可以输入三极管电路的信号，之后在输出端再经过衰减获得一个STM32易于采样的电压幅度范围。</p>
<p>通过STM32单片机程序修改频率控制字和幅度控制字实现激励输出信号的频率和幅度调节，输入被测网络。通过提高DDS输出幅度与固定衰减器配合工作提高输出信号的信噪比，被测网络输出信号通过继电器选择是否连接交流负载，可分别测量空载电压和带载电压等。</p>
<p>输出信号经片上16bit模数转换器转换后输入STM32，经分析计算后，得到被测网络的各项电路参数，将结果显示在串口触摸屏。</p>
<p><img src="/2022/07/16/ProgramLearn/Embed/%E6%9A%91%E5%81%87%E7%AC%AC%E4%BA%8C%E6%AC%A1%E8%AE%AD%E7%BB%83%E9%A2%98/系统框图-16575399219541.png" alt="系统框图" style="zoom:50%;"></p>
<p>系统框图如上。</p>
<h2 id="二、理论分析与计算"><a href="#二、理论分析与计算" class="headerlink" title="二、理论分析与计算"></a>二、理论分析与计算</h2><h3 id="2-1-待测电路"><a href="#2-1-待测电路" class="headerlink" title="2.1  待测电路"></a>2.1  待测电路</h3><p>待测电路由题目给出，为一个三极管放大器反向放大器。基础部分为需要设计检测仪能够检测放大电路的输入电阻、输出电阻、增益和频幅特性曲线，由于搭建的反向放大电路只有一个输入输出端口，所以不能采用一般的方式去求出我们需要的。我们必须采用其他方式来获取我们所需要的。</p>
<p><img src="/2022/07/16/ProgramLearn/Embed/%E6%9A%91%E5%81%87%E7%AC%AC%E4%BA%8C%E6%AC%A1%E8%AE%AD%E7%BB%83%E9%A2%98/image-20220711194647584.png" alt="image-20220711194647584" style="zoom:50%;"></p>
<p>在这里我们采用继电器的方式来搭建电路实验课中我们常见的输入输出电阻测量电路，通过在输入端串联采样电阻，以及在输出端并联采样电阻，我们能够通过二次电压法得到输入，输出电阻。</p>
<p>如下二图所示，输入和通过S7和S8，可以改变原电路与采样电阻之间的连接关系，我们能够通过测量输入、输出电阻两端电压确定其分压后得到输入和输出电阻的值。</p>
<p><img src="/2022/07/16/ProgramLearn/Embed/%E6%9A%91%E5%81%87%E7%AC%AC%E4%BA%8C%E6%AC%A1%E8%AE%AD%E7%BB%83%E9%A2%98/image-20220711195608205.png" alt="输入电阻测量" style="zoom:50%;"></p>
<p><img src="/2022/07/16/ProgramLearn/Embed/%E6%9A%91%E5%81%87%E7%AC%AC%E4%BA%8C%E6%AC%A1%E8%AE%AD%E7%BB%83%E9%A2%98/image-20220711195654269.png" alt="输出电阻测量电路" style="zoom:50%;"></p>
<p>可将上述电路简化为：</p>
<p><img src="/2022/07/16/ProgramLearn/Embed/%E6%9A%91%E5%81%87%E7%AC%AC%E4%BA%8C%E6%AC%A1%E8%AE%AD%E7%BB%83%E9%A2%98/image-20220711200131566.png" alt="输入电阻模型"></p>
<p>那么其输入电阻为：</p>
<script type="math/tex; mode=display">
R_i=\frac{U_i}{I_i}=\frac{U_i}{\frac{U_s-U_i}{R} }=\frac{U_i}{U_s-U_i}R</script><p>同理，输出电阻的测量模型可被简化，放大电路的输出端可看成有源二端网络。：</p>
<p><img src="/2022/07/16/ProgramLearn/Embed/%E6%9A%91%E5%81%87%E7%AC%AC%E4%BA%8C%E6%AC%A1%E8%AE%AD%E7%BB%83%E9%A2%98/image-20220711200650035.png" alt="输出电阻测量模型" style="zoom:50%;"></p>
<p>那么其输出电阻为：</p>
<script type="math/tex; mode=display">
R_i=\frac{U_0'-U_0}{\frac{U_0}{R_L}}=(\frac{U_0'}{U_0}-1)R_L</script><p>同样，我们可以在其无负载工作时，在其输入和输出端口进行电压的采样，同时通过DDS进行扫频信号的发生来获得其幅频特性。</p>
<h3 id="2-2-信号发生和衰减"><a href="#2-2-信号发生和衰减" class="headerlink" title="2.2  信号发生和衰减"></a>2.2  信号发生和衰减</h3><p>本次我们采用DDS进行信号的发生，原因在于DDS方便给出幅度和频率较为容易固定的稳定正弦信号。本次使用的模块为康威科技的AD9834模块，根据其原理图，我们容易发现该DDS模块使用SMA输出，同时也添加了LC滤波器。而本次扫频需要用到的1000Hz到200kHz以上均处于该模块滤波器的通频带上，同时SMA和滤波器的组合也让该DDS的信号噪音较少。</p>
<p>综上，本题目中我们采用的DDS能够给出较为稳定的<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.65ex;" xmlns="http://www.w3.org/2000/svg" width="3.116ex" height="2.195ex" role="img" focusable="false" viewbox="0 -683 1377.3 970.2"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D449" d="M52 648Q52 670 65 683H76Q118 680 181 680Q299 680 320 683H330Q336 677 336 674T334 656Q329 641 325 637H304Q282 635 274 635Q245 630 242 620Q242 618 271 369T301 118L374 235Q447 352 520 471T595 594Q599 601 599 609Q599 633 555 637Q537 637 537 648Q537 649 539 661Q542 675 545 679T558 683Q560 683 570 683T604 682T668 681Q737 681 755 683H762Q769 676 769 672Q769 655 760 640Q757 637 743 637Q730 636 719 635T698 630T682 623T670 615T660 608T652 599T645 592L452 282Q272 -9 266 -16Q263 -18 259 -21L241 -22H234Q216 -22 216 -15Q213 -9 177 305Q139 623 138 626Q133 637 76 637H59Q52 642 52 648Z"/></g><g data-mml-node="TeXAtom" transform="translate(616,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"/></g><g data-mml-node="mi" transform="translate(503,0)"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"/></g></g></g></g></g></svg></mjx-container> 为</p>
<p><img src="/2022/07/16/ProgramLearn/Embed/%E6%9A%91%E5%81%87%E7%AC%AC%E4%BA%8C%E6%AC%A1%E8%AE%AD%E7%BB%83%E9%A2%98/image-20220711202233299.png" alt="AD9834模块原理图" style="zoom:50%;"></p>
<p>由于该放大器在搭建时，其静态工作点已经被选定，所以在该选定静态工作点时，我们寻找一个较为合适的输入电压来获得一个能有较好测量结果的输出电压——由于在进行故障分析时，其输出电压可能为12V，而本次采用的ADC的电压测量上限为3.3V，所以其输出必须被衰减。这里我们选择衰减了4倍，也就是说，在该电路进行放大被衰减后，我们仍然需要一个能由STM32片上ADC准确测得的电压值。</p>
<p>在这里，我们通过模拟仿真得到放大结果后进行分析汇总，发现在输入为20mV时，在常见的扫频频率下，其放大的交流电压幅值能到2-2.5V左右，同时直流成分在7V左右，即使经过4倍衰减也能够较好地被ADC分辨。</p>
<p><strong>综上所述，</strong>我们使用运算放大器NE5532实现衰减器的搭建。该运算放大器<em>**</em>是高性能低噪声双运算放大器（双运放）集成电路。与很多标准运放相似，但它具有更好的噪声性能，优良的输出驱动能力 及相当高的小信号带宽，电源电压范围大等特点。因此很适合应用在高品质和专业音响设备、仪器、控制电路及电话通道放大器。</p>
<p><img src="/2022/07/16/ProgramLearn/Embed/%E6%9A%91%E5%81%87%E7%AC%AC%E4%BA%8C%E6%AC%A1%E8%AE%AD%E7%BB%83%E9%A2%98/0dd7912397dda14436109687b0b7d0a20cf486ee.jpg" alt="NE5532衰减器" style="zoom:33%;"></p>
<h3 id="2-3-测量电路模块"><a href="#2-3-测量电路模块" class="headerlink" title="2.3  测量电路模块"></a>2.3  测量电路模块</h3><p>在前一节已经展示过结构。</p>
<ol>
<li>使用继电器让采样电阻与输入串联来获得输入电阻。</li>
<li>使用几点爱让采样电阻与输出并联来获得输出电阻。</li>
</ol>
<h3 id="2-4-处理器模块"><a href="#2-4-处理器模块" class="headerlink" title="2.4  处理器模块"></a>2.4  处理器模块</h3><p>由于本次使用的MCU仅有2个ADC外设，同时由于判断发展指标需要用到同步采样，在2个ADC同时被设置为同步模式时，使用定时器触发仅能使用1通道来保证2个ADC采样的实时性，故使用继电器与待测电路连接来获得采样电阻两端电压，同时不影响获取无负载电压。结构如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">graph LR;</span><br><span class="line">    MCU[STM32H7B0]--&gt;A1[ADC1]--继电器1状态1--&gt;In[输入采样电路左端]</span><br><span class="line">    A1--继电器1状态2--&gt;In2[采样电阻右端]</span><br><span class="line">    MCU--&gt;A2[ADC2]--继电器2状态1--&gt;输出采样电路正极---C(由于输出采样电阻接地,无须其他继电器)</span><br><span class="line">    A2--继电器2状态2--&gt;无负载输出电路</span><br><span class="line">    In---B(此端可由继电器3控制作为采样或者无负载)</span><br></pre></td></tr></table></figure>
<h2 id="三、电路与程序设计"><a href="#三、电路与程序设计" class="headerlink" title="三、电路与程序设计"></a>三、电路与程序设计</h2><h3 id="3-1-电路设计"><a href="#3-1-电路设计" class="headerlink" title="3.1 电路设计"></a>3.1 电路设计</h3><h4 id="1-待测电路设计"><a href="#1-待测电路设计" class="headerlink" title="(1)  待测电路设计"></a>(1)  待测电路设计</h4><p>本次电路设计主要为在原有电路的基础上添加继电器让ADC的采样点、采样电阻的接入状态发生变化，总体简化仿真框图如下，详细说明见图下方：</p>
<p><img src="/2022/07/16/ProgramLearn/Embed/%E6%9A%91%E5%81%87%E7%AC%AC%E4%BA%8C%E6%AC%A1%E8%AE%AD%E7%BB%83%E9%A2%98/image-20220711212641617.png" alt="电路设计" style="zoom:50%;"></p>
<p>说明：</p>
<ol>
<li>在本电路设计中，主体部分为题目中给出的待测电路加上R5,R6两个采样电阻。</li>
<li>所有既有电容电阻前的开关为仿真发展指标时使用，在实际电路中被接线端子代替。</li>
<li>使用的继电器为S8和被探针3遮挡的S6。</li>
<li>中控制ADC1采集输入电阻两端的继电器被省略。</li>
<li>信号发生器为DDS电路与信号衰减器的结合。其中，衰减器结构见上文。</li>
</ol>
<h3 id="3-2-程序设计"><a href="#3-2-程序设计" class="headerlink" title="3.2 程序设计"></a>3.2 程序设计</h3><h4 id="1-程序主体设计"><a href="#1-程序主体设计" class="headerlink" title="(1) 程序主体设计"></a>(1) 程序主体设计</h4><p>本程序的主体设计为线性设计，使用<code>Global_Status</code>进结构体状态机对于系统运行状态在有整体校验没有异常后，对于标准指标进行测试；在校验出现异常时进行发展指标的测试，即检查电路问题。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (<span class="number">1</span>)</span><br><span class="line">{</span><br><span class="line">  Circuit_Init(); <span class="comment">//对于电路整体初始化，继电器位置默认电路正常运行状态</span></span><br><span class="line">  <span class="keyword">if</span> (!Global_Status.error_detect)<span class="comment">//首先对系统状态机进行判断，如果出现问题自动开始修复问题</span></span><br><span class="line">  {</span><br><span class="line">    Global_Status.Ri = GetRi(); <span class="comment">//获得输入电阻的值</span></span><br><span class="line">    Global_Status.Ro = GetRo(); <span class="comment">//获得输出电阻的值</span></span><br><span class="line">    Global_Status.Au = GetAu(); <span class="comment">//获取增益并且输出，同时承担了测量直流和交流的工作</span></span><br><span class="line">    Scan_HZ(&amp;Global_Status.L_hz, &amp;Global_Status.H_hz);  <span class="comment">//扫频获得截止频率</span></span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  {</span><br><span class="line">    Global_Status.error = Detect_Error(); <span class="comment">//进行错误检测，即进行发展指标发现的尝试。</span></span><br><span class="line">  }</span><br><span class="line">  GUI_Out();  <span class="comment">//在串口屏上打印数据</span></span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>流程图如下:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">graph TD;</span><br><span class="line">    Start(开始)--&gt;进行电路初始化--&gt;Check{{对全局结构体中,电路状态值进行校验}}--正常&lt;/br&gt;改变继电器位置--&gt;F0</span><br><span class="line">    Check--非正常--&gt;Error_Check;</span><br><span class="line">    subgraph Sub1[顺序检测模块];</span><br><span class="line">        F0[求输入和输出电阻]--改变继电器位置&lt;/br&gt;让电路恢复正常--&gt;F1[求有效值和扫频]</span><br><span class="line">        Exp(凡是在本部分&lt;/br&gt;检查出现错误的值&lt;/br&gt;,向全局结构体中&lt;/br&gt;电路状态值添加)</span><br><span class="line">    end</span><br><span class="line"></span><br><span class="line">    subgraph Sub2[异常诊断模块]</span><br><span class="line">        Error_Check[对于以上&lt;/br&gt;采集到的&lt;/br&gt;异常数据&lt;/br&gt;进行分析]--&gt;Err_rslt[并且添加在&lt;/br&gt;状态结构体中]</span><br><span class="line">    end</span><br><span class="line">    END_LOOP(结束循环并打印到串口屏);</span><br><span class="line">    F1--&gt;END_LOOP;Err_rslt--&gt;END_LOOP--&gt;C(进行下一轮校验)</span><br></pre></td></tr></table></figure>
<p>其中，使用的全局状态结构体提供绝大多数的错误判定，以及起最后的结果输出作用：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//全局状态结构体</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span>{</span></span><br><span class="line">    <span class="type">uint8_t</span> ADC_OK;<span class="comment">//ADC数据准备完成标志</span></span><br><span class="line">    <span class="type">uint8_t</span> FirstChange;<span class="comment">//电路结构改变标志</span></span><br><span class="line">    <span class="type">uint8_t</span> error_detect;<span class="comment">//是否开启故障检查标志</span></span><br><span class="line"></span><br><span class="line">    <span class="type">float32_t</span> Ri;<span class="comment">//输入电阻</span></span><br><span class="line">    <span class="type">float32_t</span> Ro;<span class="comment">//输出电阻</span></span><br><span class="line">    <span class="type">float32_t</span> Au;<span class="comment">//增益-中频</span></span><br><span class="line">    <span class="type">float32_t</span> H_hz;<span class="comment">//上限截止频率</span></span><br><span class="line">    <span class="type">float32_t</span> L_hz;<span class="comment">//下限截止频率</span></span><br><span class="line"></span><br><span class="line">    <span class="type">float32_t</span> DC_out;<span class="comment">//输出直流</span></span><br><span class="line">    <span class="type">float32_t</span> AC_out;<span class="comment">//输出交流</span></span><br><span class="line"></span><br><span class="line">    ErrorType error;<span class="comment">//电路故障状态</span></span><br><span class="line">    CircuitMode Mode;<span class="comment">//电路状态</span></span><br><span class="line">}Status;    </span><br><span class="line"></span><br><span class="line"><span class="comment">//异常状态结构体</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">enum</span> {</span></span><br><span class="line">    NO_EEROR=<span class="number">0</span>,<span class="comment">//正常</span></span><br><span class="line">    R1_BR,<span class="comment">//R1断路</span></span><br><span class="line">    R2_BR,<span class="comment">//R2断路</span></span><br><span class="line">    R3_BR,<span class="comment">//R3断路</span></span><br><span class="line">    R4_BR,<span class="comment">//R4断路</span></span><br><span class="line">    R1_SH,<span class="comment">//R1短路</span></span><br><span class="line">    R2_SH,<span class="comment">//R2短路</span></span><br><span class="line">    R3_SH,<span class="comment">//R3短路</span></span><br><span class="line">    R4_SH,<span class="comment">//R4短路</span></span><br><span class="line">    C1_BR,<span class="comment">//C1断路</span></span><br><span class="line">    C2_BR,<span class="comment">//C2断路</span></span><br><span class="line">    C3_BR,<span class="comment">//C3断路</span></span><br><span class="line">    C1_ADD,<span class="comment">//C1增加</span></span><br><span class="line">    C2_ADD,<span class="comment">//C2增加</span></span><br><span class="line">    C3_ADD,<span class="comment">//C3增加</span></span><br><span class="line">}ErrorType;</span><br></pre></td></tr></table></figure>
<h4 id="2-FFT采样设计"><a href="#2-FFT采样设计" class="headerlink" title="(2)  FFT采样设计"></a>(2)  FFT采样设计</h4><p>我们在本题借助FFT求取其幅频特性，分离直流。使用ARM的DSP库进行32位浮点数的FFT运算。</p>
<p>对于ADC采样数据的转换、之后使用ARM_FFT运算，代码如下，逻辑简单，其中调用函数顺序为<code>GetMagFromADC-&gt;Myfft_mag-&gt;arm_cfft_f32_app</code>逻辑简单，故不再赘述：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">*************************************************************</span></span><br><span class="line"><span class="comment">* 从ADC获取电压幅值</span></span><br><span class="line"><span class="comment">* Adc1Va：储存ADC1的结果，Adc2Va：储存ADC2的结果</span></span><br><span class="line"><span class="comment">* return：NONE</span></span><br><span class="line"><span class="comment">*************************************************************</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">GetMagFromADC</span><span class="params">(FFT_Result *Adc1Va,FFT_Result *Adc2Va)</span></span><br><span class="line">{</span><br><span class="line">    <span class="keyword">while</span>(!Global_Status.ADC_OK){};<span class="comment">//等待ADC转化完毕</span></span><br><span class="line">    Global_Status.ADC_OK=<span class="number">0</span>;<span class="comment">//清除ADC标志</span></span><br><span class="line"></span><br><span class="line">    <span class="type">uint16_t</span> ADC1_Values[<span class="number">1024</span>];</span><br><span class="line">    <span class="type">uint16_t</span> ADC2_Values[<span class="number">1024</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">uint16_t</span> i = <span class="number">0</span>;i &lt; <span class="number">1024</span>;i++) </span><br><span class="line">    {</span><br><span class="line">    ADC2_Values[i] = (<span class="type">uint16_t</span>)((ADC_Double_Values[i] &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xffff</span>);<span class="comment">//高16位保存ADC2</span></span><br><span class="line">    ADC1_Values[i] = (<span class="type">uint16_t</span>)(ADC_Double_Values[i] &amp; <span class="number">0xffff</span>);<span class="comment">//低16位保存ADC1</span></span><br><span class="line">    }</span><br><span class="line">    Myfft_mag(ADC1_Values,Order,Adc1Va);</span><br><span class="line">    Myfft_mag(ADC2_Values,Order,Adc2Va);</span><br><span class="line">    ADC_Start();</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">*FFT运算函数,得到特定频率模值</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*ADC_In：ADC数据数组,大小1024</span></span><br><span class="line"><span class="comment">*FFT_Result:FFT运算结果结构体</span></span><br><span class="line"><span class="comment">*Order:信号在频谱中的位置</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Myfft_mag</span><span class="params">(<span class="type">uint16_t</span> ADC_In[], <span class="type">uint16_t</span> Order, FFT_Result* FFT_Result)</span></span><br><span class="line">{</span><br><span class="line">    arm_cfft_f32_app(ADC_In, _FFT_Out);    <span class="comment">//fft的apply，对于传入的uint16数组再次进行规划转换为float32_t数组之后使用arm_fft进行处理</span></span><br><span class="line"></span><br><span class="line">    arm_cmplx_mag_f32(_FFT_Out, _FFT_Magout, <span class="number">1024</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>;i &lt; <span class="number">1024</span>;i++)<span class="comment">//对数据进行归一化处理，直流分量除以N，其他除N/2,未去半</span></span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">if</span> (i == <span class="number">0</span>) _FFT_Magout[i] = _FFT_Magout[i] / <span class="number">1024</span>;</span><br><span class="line">        <span class="keyword">else</span> _FFT_Magout[i] = _FFT_Magout[i] / (<span class="number">1024</span> / <span class="number">2</span>);</span><br><span class="line">    }</span><br><span class="line">    FFT_Result-&gt;DC_Raw = _FFT_Magout[<span class="number">0</span>];FFT_Result-&gt;DC = (_FFT_Magout[<span class="number">0</span>] * REF_V);<span class="comment">//直流</span></span><br><span class="line">    FFT_Result-&gt;AC_Raw = _FFT_Magout[Order];FFT_Result-&gt;AC = (_FFT_Magout[Order] * REF_V);<span class="comment">//交流</span></span><br><span class="line">    arm_sqrt_f32((<span class="type">float32_t</span>)(((FFT_Result-&gt;AC) * (FFT_Result-&gt;AC) / <span class="number">2</span>) + (FFT_Result-&gt;DC) * (FFT_Result-&gt;DC)), &amp;(FFT_Result-&gt;Real));<span class="comment">//有效值</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @brief 求解FFT结果的蟹函数</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * @param _in 输入数组，长度为1024位</span></span><br><span class="line"><span class="comment"> * @param testInput_f32 输入的最后得到结果的存储数组，2048位</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">arm_cfft_f32_app</span><span class="params">(<span class="type">uint16_t</span>* _in, <span class="type">float32_t</span>* testInput_f32)</span></span><br><span class="line">{</span><br><span class="line">    <span class="type">uint8_t</span> ifftFlag = <span class="number">0</span>;</span><br><span class="line">    <span class="type">uint8_t</span> doBitReverse = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">//static uint16_t TEST_LENGTH_SAMPLES = MID;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 按照实部，虚部，实部，虚部..... 的顺序存储数据 */</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">uint16_t</span> i = <span class="number">0</span>; i &lt; <span class="number">1024</span>; i++)</span><br><span class="line">    {</span><br><span class="line">        <span class="comment">/* 波形是由直流分量，50Hz正弦波组成，波形采样率1024，初始相位60° */</span></span><br><span class="line">        testInput_f32[i * <span class="number">2</span>] = (<span class="type">float32_t</span>)_in[i];</span><br><span class="line">        testInput_f32[i * <span class="number">2</span> + <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* CFFT变换 */</span></span><br><span class="line">    arm_cfft_f32(&amp;arm_cfft_sR_f32_len1024, testInput_f32, ifftFlag, doBitReverse);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h4 id="3-输入电阻测量设计"><a href="#3-输入电阻测量设计" class="headerlink" title="(3)  输入电阻测量设计"></a>(3)  输入电阻测量设计</h4><p>由上文提及公式：<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -1.89ex;" xmlns="http://www.w3.org/2000/svg" width="26.682ex" height="4.005ex" role="img" focusable="false" viewbox="0 -934.5 11793.3 1770.1"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D445" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z"/></g><g data-mml-node="mi" transform="translate(792,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"/></g></g><g data-mml-node="mo" transform="translate(1363.7,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="mfrac" transform="translate(2419.5,0)"><g data-mml-node="msub" transform="translate(220,451.6) scale(0.707)"><g data-mml-node="mi"><path data-c="1D448" d="M107 637Q73 637 71 641Q70 643 70 649Q70 673 81 682Q83 683 98 683Q139 681 234 681Q268 681 297 681T342 682T362 682Q378 682 378 672Q378 670 376 658Q371 641 366 638H364Q362 638 359 638T352 638T343 637T334 637Q295 636 284 634T266 623Q265 621 238 518T184 302T154 169Q152 155 152 140Q152 86 183 55T269 24Q336 24 403 69T501 205L552 406Q599 598 599 606Q599 633 535 637Q511 637 511 648Q511 650 513 660Q517 676 519 679T529 683Q532 683 561 682T645 680Q696 680 723 681T752 682Q767 682 767 672Q767 650 759 642Q756 637 737 637Q666 633 648 597Q646 592 598 404Q557 235 548 205Q515 105 433 42T263 -22Q171 -22 116 34T60 167V183Q60 201 115 421Q164 622 164 628Q164 635 107 637Z"/></g><g data-mml-node="mi" transform="translate(716,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"/></g></g><g data-mml-node="msub" transform="translate(305.9,-345) scale(0.707)"><g data-mml-node="mi"><path data-c="1D43C" d="M43 1Q26 1 26 10Q26 12 29 24Q34 43 39 45Q42 46 54 46H60Q120 46 136 53Q137 53 138 54Q143 56 149 77T198 273Q210 318 216 344Q286 624 286 626Q284 630 284 631Q274 637 213 637H193Q184 643 189 662Q193 677 195 680T209 683H213Q285 681 359 681Q481 681 487 683H497Q504 676 504 672T501 655T494 639Q491 637 471 637Q440 637 407 634Q393 631 388 623Q381 609 337 432Q326 385 315 341Q245 65 245 59Q245 52 255 50T307 46H339Q345 38 345 37T342 19Q338 6 332 0H316Q279 2 179 2Q143 2 113 2T65 2T43 1Z"/></g><g data-mml-node="mi" transform="translate(473,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"/></g></g><rect width="914.1" height="60" x="120" y="220"/></g><g data-mml-node="mo" transform="translate(3851.4,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="mfrac" transform="translate(4907.2,0)"><g data-mml-node="msub" transform="translate(799.5,451.6) scale(0.707)"><g data-mml-node="mi"><path data-c="1D448" d="M107 637Q73 637 71 641Q70 643 70 649Q70 673 81 682Q83 683 98 683Q139 681 234 681Q268 681 297 681T342 682T362 682Q378 682 378 672Q378 670 376 658Q371 641 366 638H364Q362 638 359 638T352 638T343 637T334 637Q295 636 284 634T266 623Q265 621 238 518T184 302T154 169Q152 155 152 140Q152 86 183 55T269 24Q336 24 403 69T501 205L552 406Q599 598 599 606Q599 633 535 637Q511 637 511 648Q511 650 513 660Q517 676 519 679T529 683Q532 683 561 682T645 680Q696 680 723 681T752 682Q767 682 767 672Q767 650 759 642Q756 637 737 637Q666 633 648 597Q646 592 598 404Q557 235 548 205Q515 105 433 42T263 -22Q171 -22 116 34T60 167V183Q60 201 115 421Q164 622 164 628Q164 635 107 637Z"/></g><g data-mml-node="mi" transform="translate(716,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"/></g></g><g data-mml-node="mfrac" transform="translate(220,-581.1) scale(0.707)"><g data-mml-node="mrow" transform="translate(220,565.1) scale(0.707)"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D448" d="M107 637Q73 637 71 641Q70 643 70 649Q70 673 81 682Q83 683 98 683Q139 681 234 681Q268 681 297 681T342 682T362 682Q378 682 378 672Q378 670 376 658Q371 641 366 638H364Q362 638 359 638T352 638T343 637T334 637Q295 636 284 634T266 623Q265 621 238 518T184 302T154 169Q152 155 152 140Q152 86 183 55T269 24Q336 24 403 69T501 205L552 406Q599 598 599 606Q599 633 535 637Q511 637 511 648Q511 650 513 660Q517 676 519 679T529 683Q532 683 561 682T645 680Q696 680 723 681T752 682Q767 682 767 672Q767 650 759 642Q756 637 737 637Q666 633 648 597Q646 592 598 404Q557 235 548 205Q515 105 433 42T263 -22Q171 -22 116 34T60 167V183Q60 201 115 421Q164 622 164 628Q164 635 107 637Z"/></g><g data-mml-node="mi" transform="translate(716,-150)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"/></g></g><g data-mml-node="mo" transform="translate(1235,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"/></g><g data-mml-node="msub" transform="translate(2013,0)"><g data-mml-node="mi"><path data-c="1D448" d="M107 637Q73 637 71 641Q70 643 70 649Q70 673 81 682Q83 683 98 683Q139 681 234 681Q268 681 297 681T342 682T362 682Q378 682 378 672Q378 670 376 658Q371 641 366 638H364Q362 638 359 638T352 638T343 637T334 637Q295 636 284 634T266 623Q265 621 238 518T184 302T154 169Q152 155 152 140Q152 86 183 55T269 24Q336 24 403 69T501 205L552 406Q599 598 599 606Q599 633 535 637Q511 637 511 648Q511 650 513 660Q517 676 519 679T529 683Q532 683 561 682T645 680Q696 680 723 681T752 682Q767 682 767 672Q767 650 759 642Q756 637 737 637Q666 633 648 597Q646 592 598 404Q557 235 548 205Q515 105 433 42T263 -22Q171 -22 116 34T60 167V183Q60 201 115 421Q164 622 164 628Q164 635 107 637Z"/></g><g data-mml-node="mi" transform="translate(716,-307.4)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"/></g></g></g><g data-mml-node="mi" transform="translate(1056.2,-345) scale(0.707)"><path data-c="1D445" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z"/></g><rect width="2409" height="60" x="120" y="220"/></g><rect width="2073.1" height="60" x="120" y="220"/></g><g data-mml-node="mo" transform="translate(7498.1,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="mfrac" transform="translate(8553.9,0)"><g data-mml-node="msub" transform="translate(883.1,451.6) scale(0.707)"><g data-mml-node="mi"><path data-c="1D448" d="M107 637Q73 637 71 641Q70 643 70 649Q70 673 81 682Q83 683 98 683Q139 681 234 681Q268 681 297 681T342 682T362 682Q378 682 378 672Q378 670 376 658Q371 641 366 638H364Q362 638 359 638T352 638T343 637T334 637Q295 636 284 634T266 623Q265 621 238 518T184 302T154 169Q152 155 152 140Q152 86 183 55T269 24Q336 24 403 69T501 205L552 406Q599 598 599 606Q599 633 535 637Q511 637 511 648Q511 650 513 660Q517 676 519 679T529 683Q532 683 561 682T645 680Q696 680 723 681T752 682Q767 682 767 672Q767 650 759 642Q756 637 737 637Q666 633 648 597Q646 592 598 404Q557 235 548 205Q515 105 433 42T263 -22Q171 -22 116 34T60 167V183Q60 201 115 421Q164 622 164 628Q164 635 107 637Z"/></g><g data-mml-node="mi" transform="translate(716,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"/></g></g><g data-mml-node="mrow" transform="translate(220,-345) scale(0.707)"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D448" d="M107 637Q73 637 71 641Q70 643 70 649Q70 673 81 682Q83 683 98 683Q139 681 234 681Q268 681 297 681T342 682T362 682Q378 682 378 672Q378 670 376 658Q371 641 366 638H364Q362 638 359 638T352 638T343 637T334 637Q295 636 284 634T266 623Q265 621 238 518T184 302T154 169Q152 155 152 140Q152 86 183 55T269 24Q336 24 403 69T501 205L552 406Q599 598 599 606Q599 633 535 637Q511 637 511 648Q511 650 513 660Q517 676 519 679T529 683Q532 683 561 682T645 680Q696 680 723 681T752 682Q767 682 767 672Q767 650 759 642Q756 637 737 637Q666 633 648 597Q646 592 598 404Q557 235 548 205Q515 105 433 42T263 -22Q171 -22 116 34T60 167V183Q60 201 115 421Q164 622 164 628Q164 635 107 637Z"/></g><g data-mml-node="mi" transform="translate(716,-150) scale(0.707)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"/></g></g><g data-mml-node="mo" transform="translate(1097.6,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"/></g><g data-mml-node="msub" transform="translate(1875.6,0)"><g data-mml-node="mi"><path data-c="1D448" d="M107 637Q73 637 71 641Q70 643 70 649Q70 673 81 682Q83 683 98 683Q139 681 234 681Q268 681 297 681T342 682T362 682Q378 682 378 672Q378 670 376 658Q371 641 366 638H364Q362 638 359 638T352 638T343 637T334 637Q295 636 284 634T266 623Q265 621 238 518T184 302T154 169Q152 155 152 140Q152 86 183 55T269 24Q336 24 403 69T501 205L552 406Q599 598 599 606Q599 633 535 637Q511 637 511 648Q511 650 513 660Q517 676 519 679T529 683Q532 683 561 682T645 680Q696 680 723 681T752 682Q767 682 767 672Q767 650 759 642Q756 637 737 637Q666 633 648 597Q646 592 598 404Q557 235 548 205Q515 105 433 42T263 -22Q171 -22 116 34T60 167V183Q60 201 115 421Q164 622 164 628Q164 635 107 637Z"/></g><g data-mml-node="mi" transform="translate(716,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"/></g></g></g><rect width="2240.4" height="60" x="120" y="220"/></g><g data-mml-node="mi" transform="translate(11034.3,0)"><path data-c="1D445" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z"/></g></g></g></g></svg></mjx-container>可知，使用双电压法求得输出电阻需要经过如下几个步骤：</p>
<ol>
<li><p>电路为初始状态值时，求得无负载时的输入电压：<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.355ex;" xmlns="http://www.w3.org/2000/svg" width="2.483ex" height="1.901ex" role="img" focusable="false" viewbox="0 -683 1097.6 840.1"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D448" d="M107 637Q73 637 71 641Q70 643 70 649Q70 673 81 682Q83 683 98 683Q139 681 234 681Q268 681 297 681T342 682T362 682Q378 682 378 672Q378 670 376 658Q371 641 366 638H364Q362 638 359 638T352 638T343 637T334 637Q295 636 284 634T266 623Q265 621 238 518T184 302T154 169Q152 155 152 140Q152 86 183 55T269 24Q336 24 403 69T501 205L552 406Q599 598 599 606Q599 633 535 637Q511 637 511 648Q511 650 513 660Q517 676 519 679T529 683Q532 683 561 682T645 680Q696 680 723 681T752 682Q767 682 767 672Q767 650 759 642Q756 637 737 637Q666 633 648 597Q646 592 598 404Q557 235 548 205Q515 105 433 42T263 -22Q171 -22 116 34T60 167V183Q60 201 115 421Q164 622 164 628Q164 635 107 637Z"/></g><g data-mml-node="mi" transform="translate(716,-150) scale(0.707)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"/></g></g></g></g></svg></mjx-container></p>
</li>
<li><p>将待测电阻接入电路，求得采样电阻<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.048ex;" xmlns="http://www.w3.org/2000/svg" width="1.717ex" height="1.593ex" role="img" focusable="false" viewbox="0 -683 759 704"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D445" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z"/></g></g></g></svg></mjx-container>两端的电压差<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.357ex;" xmlns="http://www.w3.org/2000/svg" width="2.285ex" height="1.902ex" role="img" focusable="false" viewbox="0 -683 1010 840.8"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D448" d="M107 637Q73 637 71 641Q70 643 70 649Q70 673 81 682Q83 683 98 683Q139 681 234 681Q268 681 297 681T342 682T362 682Q378 682 378 672Q378 670 376 658Q371 641 366 638H364Q362 638 359 638T352 638T343 637T334 637Q295 636 284 634T266 623Q265 621 238 518T184 302T154 169Q152 155 152 140Q152 86 183 55T269 24Q336 24 403 69T501 205L552 406Q599 598 599 606Q599 633 535 637Q511 637 511 648Q511 650 513 660Q517 676 519 679T529 683Q532 683 561 682T645 680Q696 680 723 681T752 682Q767 682 767 672Q767 650 759 642Q756 637 737 637Q666 633 648 597Q646 592 598 404Q557 235 548 205Q515 105 433 42T263 -22Q171 -22 116 34T60 167V183Q60 201 115 421Q164 622 164 628Q164 635 107 637Z"/></g><g data-mml-node="mi" transform="translate(716,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"/></g></g></g></g></svg></mjx-container></p>
<blockquote>
<p>这里由于我们并未使用2路ADC对于对于采样电阻两端的电压进行直接采集，而是使用电位器，分2次采集该电阻两端的电压</p>
</blockquote>
</li>
<li><p>其中，输入和电压差都为电压有效值: ,由于这里是正弦信号，我们可以将这个值化简为：${U=\sqrt{U<em>{DC}^2+\frac{U</em>{AC}^2}{2}}}$</p>
</li>
<li><p>至此，我们可以根据如上逻辑写出对应的<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.357ex;" xmlns="http://www.w3.org/2000/svg" width="2.457ex" height="1.902ex" role="img" focusable="false" viewbox="0 -683 1086 840.8"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D445" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z"/></g><g data-mml-node="mi" transform="translate(792,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"/></g></g></g></g></svg></mjx-container>的对应程序。</p>
</li>
</ol>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">float32_t</span> <span class="title function_">GetRi</span><span class="params">(<span class="type">void</span>)</span><span class="comment">//获取输入电阻</span></span><br><span class="line">{</span><br><span class="line">    <span class="type">float32_t</span> Ri = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">//由于只有两个ADC,使用ADC1测输出，使用ADC2测输入</span></span><br><span class="line">    <span class="comment">//ADC2先通过短路采样电阻测DDS的输出，然后接入采样电阻测右端电压</span></span><br><span class="line">    <span class="comment">/*先测Rs左端电压*/</span></span><br><span class="line">    FFT_Result L_values = { <span class="number">0</span> };</span><br><span class="line">    ChangeCircuit(MODE_NORMAL);<span class="comment">//短路采样电阻</span></span><br><span class="line">    GetMagFromADC2(&amp;L_values);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/*再测Rs右端电压*/</span></span><br><span class="line">    FFT_Result R_values = { <span class="number">0</span> };</span><br><span class="line">    ChangeCircuit(HAVE_INPUT);<span class="comment">//接入采样电阻</span></span><br><span class="line">    GetMagFromADC2(&amp;R_values);</span><br><span class="line"></span><br><span class="line">    Ri = R_values.Real * INPUT_R / (L_values.Real - R_values.Real);<span class="comment">//不需要乘增益</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> Ri;    <span class="comment">//返回值为输入电阻值</span></span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h4 id="4-输出电阻测量设计"><a href="#4-输出电阻测量设计" class="headerlink" title="(4)  输出电阻测量设计"></a>(4)  输出电阻测量设计</h4><p>由公式：</p>
<script type="math/tex; mode=display">
R_i=\frac{U_0'-U_0}{\frac{U_0}{R_L}}=(\frac{U_0'}{U_0}-1)R_L</script><p>可知，我们需要在电路空载的情况下，先求得空负载时的输出电压<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.375ex;" xmlns="http://www.w3.org/2000/svg" width="2.533ex" height="1.92ex" role="img" focusable="false" viewbox="0 -683 1119.6 848.6"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D448" d="M107 637Q73 637 71 641Q70 643 70 649Q70 673 81 682Q83 683 98 683Q139 681 234 681Q268 681 297 681T342 682T362 682Q378 682 378 672Q378 670 376 658Q371 641 366 638H364Q362 638 359 638T352 638T343 637T334 637Q295 636 284 634T266 623Q265 621 238 518T184 302T154 169Q152 155 152 140Q152 86 183 55T269 24Q336 24 403 69T501 205L552 406Q599 598 599 606Q599 633 535 637Q511 637 511 648Q511 650 513 660Q517 676 519 679T529 683Q532 683 561 682T645 680Q696 680 723 681T752 682Q767 682 767 672Q767 650 759 642Q756 637 737 637Q666 633 648 597Q646 592 598 404Q557 235 548 205Q515 105 433 42T263 -22Q171 -22 116 34T60 167V183Q60 201 115 421Q164 622 164 628Q164 635 107 637Z"/></g><g data-mml-node="mn" transform="translate(716,-150) scale(0.707)"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"/></g></g></g></g></svg></mjx-container> ，再将<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.339ex;" xmlns="http://www.w3.org/2000/svg" width="2.994ex" height="1.885ex" role="img" focusable="false" viewbox="0 -683 1323.5 833"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D445" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z"/></g><g data-mml-node="mi" transform="translate(792,-150) scale(0.707)"><path data-c="1D43F" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"/></g></g></g></g></svg></mjx-container> 串入，测得<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.618ex;" xmlns="http://www.w3.org/2000/svg" width="2.533ex" height="2.335ex" role="img" focusable="false" viewbox="0 -759 1119.6 1032.1"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msubsup"><g data-mml-node="mi"><path data-c="1D448" d="M107 637Q73 637 71 641Q70 643 70 649Q70 673 81 682Q83 683 98 683Q139 681 234 681Q268 681 297 681T342 682T362 682Q378 682 378 672Q378 670 376 658Q371 641 366 638H364Q362 638 359 638T352 638T343 637T334 637Q295 636 284 634T266 623Q265 621 238 518T184 302T154 169Q152 155 152 140Q152 86 183 55T269 24Q336 24 403 69T501 205L552 406Q599 598 599 606Q599 633 535 637Q511 637 511 648Q511 650 513 660Q517 676 519 679T529 683Q532 683 561 682T645 680Q696 680 723 681T752 682Q767 682 767 672Q767 650 759 642Q756 637 737 637Q666 633 648 597Q646 592 598 404Q557 235 548 205Q515 105 433 42T263 -22Q171 -22 116 34T60 167V183Q60 201 115 421Q164 622 164 628Q164 635 107 637Z"/></g><g data-mml-node="mo" transform="translate(854.2,363) scale(0.707)"><path data-c="2032" d="M79 43Q73 43 52 49T30 61Q30 68 85 293T146 528Q161 560 198 560Q218 560 240 545T262 501Q262 496 260 486Q259 479 173 263T84 45T79 43Z"/></g><g data-mml-node="mn" transform="translate(716,-257.5) scale(0.707)"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"/></g></g></g></g></svg></mjx-container> 。之后套入公式，对应程序如下。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">float32_t</span> <span class="title function_">GetRo</span><span class="params">(<span class="type">void</span>)</span><span class="comment">//获取输出电阻</span></span><br><span class="line">{</span><br><span class="line">    <span class="type">float32_t</span> Ro = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">//使用ADC1测输出电阻</span></span><br><span class="line">    <span class="comment">/*先测空载*/</span></span><br><span class="line">    FFT_Result L_values = { <span class="number">0</span> };</span><br><span class="line">    ChangeCircuit(MODE_NORMAL);</span><br><span class="line">    GetMagFromADC1(&amp;L_values);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*再测负载*/</span></span><br><span class="line">    FFT_Result R_values = { <span class="number">0</span> };</span><br><span class="line">    ChangeCircuit(HAVE_OUTPUT);</span><br><span class="line">    GetMagFromADC1(&amp;R_values);</span><br><span class="line"></span><br><span class="line">    Ro = (L_values.Real / R_values.Real - <span class="number">1</span>) * OUTPUT_R;<span class="comment">//不需要乘增益</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> Ro;    <span class="comment">//返回值为输出电阻值</span></span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h4 id="5-求解增益程序设计"><a href="#5-求解增益程序设计" class="headerlink" title="(5)  求解增益程序设计"></a>(5)  求解增益程序设计</h4><p>在设计求增益程序的过程当中，我们将电路恢复至正常状态之后，进行测量，具体的测量步骤已经在代码注释中体现，不再赘述。在求增益的过程当中，我们充分利用了上述FFT程序模块当中提供的接口，做到了简洁和清洗。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">float32_t</span> <span class="title function_">GetAu</span><span class="params">(<span class="type">void</span>)</span><span class="comment">//获得增益</span></span><br><span class="line">{</span><br><span class="line">    <span class="type">float32_t</span> Au = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">//使用ADC1测输出，使用ADC2测输入</span></span><br><span class="line">    <span class="comment">//增益的计算公式Au=20lg(Uo/ui)</span></span><br><span class="line">    FFT_Result IN_values = { <span class="number">0</span> }, OUT_values = { <span class="number">0</span> };</span><br><span class="line">    ChangeCircuit(MODE_NORMAL);</span><br><span class="line">    GetMagFromADC(&amp;OUT_values, &amp;IN_values);</span><br><span class="line"></span><br><span class="line">    Au = OUT_values.AC / IN_values.AC;<span class="comment">//通过对于交流直接相除得到增益</span></span><br><span class="line"></span><br><span class="line">    Global_Status.AC_out = OUT_values.AC * OUTPUT_GAIN;<span class="comment">//幅度</span></span><br><span class="line">    Global_Status.DC_out = OUT_values.DC * OUTPUT_GAIN;<span class="comment">//直流</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> Au;    <span class="comment">//返回值为得到的增益值</span></span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h4 id="5-扫频模块程序设计"><a href="#5-扫频模块程序设计" class="headerlink" title="(5)   扫频模块程序设计"></a>(5)   扫频模块程序设计</h4><p>在扫频模块当中，由于我们在本题借助FFT求取其幅频特性，分离直流，在进行扫频的过程当中，需要对于采样速率有着较为阉割的限制，因此我们的代码需要对于基波频率和采样频率都进行设置，通过定时器触发让ADC的采样间隔较为稳定，从而便于我们在频谱中找到我们需要的模值和直流。代码展示设置定时器部分。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">graph TD</span><br><span class="line">    Head(&lt;strong&gt;传入数据:&lt;/br&gt;待扫频率,总采样点数,设置触发的定时器)--&gt;AUTO0[&lt;strong&gt;设置DDS频率,计算采样频率&lt;/strong&gt;&lt;/br&gt;在低频时采样倍率更高&lt;/br&gt;高频时更高]--&gt;AUTO1[&lt;strong&gt;进行采样率与定时器定时时间的转化&lt;/strong&gt;&lt;/br&gt;将采样率转化为时间后与系统主频进行&lt;/br&gt;公约数运算之后设置定时器]</span><br><span class="line">    AUTO1--&gt;END(将最终该频率&lt;strong&gt;在频谱上的位置&lt;/&gt;返回)</span><br></pre></td></tr></table></figure>
<p>进行定时器时间转化的代码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//配合AutoSetTim使用的修改计时器的函数</span></span><br><span class="line"><span class="type">static</span> <span class="type">uint16_t</span> <span class="title function_">CalARRBySamplingRate</span><span class="params">(<span class="type">uint32_t</span> SamplingRate, TIM_HandleTypeDef* htim)</span> {</span><br><span class="line">    <span class="type">uint32_t</span> totalDashed = RCC_Rate / (<span class="type">float</span>)SamplingRate;  <span class="comment">//求出填入定时器中的主时钟总周期数量</span></span><br><span class="line"></span><br><span class="line">    <span class="type">uint16_t</span> Period;    <span class="comment">//定时器间隔 </span></span><br><span class="line">    <span class="type">uint16_t</span> step = <span class="number">1</span>;  <span class="comment">//循环运算步长</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">uint32_t</span> Prescaler<span class="comment">/*预分频*/</span> = <span class="number">2</span>;Prescaler &lt; totalDashed / <span class="number">2</span> || Prescaler &lt; <span class="number">0xffff</span>; Prescaler += step) {</span><br><span class="line">        <span class="comment">//从小到大寻找n的因数</span></span><br><span class="line">        <span class="keyword">while</span> (totalDashed % Prescaler == <span class="number">0</span>)   <span class="comment">//当n%j（因数）== 0时，继续分解</span></span><br><span class="line">        {</span><br><span class="line">            step = Prescaler;   <span class="comment">//如果能除余，下一次加上分频的步长</span></span><br><span class="line">            <span class="keyword">if</span> (totalDashed / Prescaler &lt;= <span class="number">0xffff</span>   <span class="comment">/*周期的值进行预判断*/</span>) {</span><br><span class="line">                Period = totalDashed / Prescaler;</span><br><span class="line">                __HAL_TIM_SET_PRESCALER(htim, Period - <span class="number">1</span>);  <span class="comment">//设置定时区间</span></span><br><span class="line">                __HAL_TIM_SetAutoreload(htim, Prescaler - <span class="number">1</span>);   <span class="comment">//设置预分频</span></span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;   <span class="comment">//正常返回</span></span><br><span class="line">            }</span><br><span class="line">            <span class="keyword">else</span> {</span><br><span class="line">                <span class="keyword">break</span>;  <span class="comment">//如果不满足要求就重新运算，直到周期和预分频都小于0xffff能够放入寄存器</span></span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;   <span class="comment">//返回错误代码，重新处理</span></span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h4 id="6-发展指标测量设计"><a href="#6-发展指标测量设计" class="headerlink" title="(6)  发展指标测量设计"></a>(6)  发展指标测量设计</h4><p>通过列出结构体，结合本次题目的仿真结果，对于相应电路特性进行判定，得到最终电路出现问题的地方。</p>
<p><img src="/2022/07/16/ProgramLearn/Embed/%E6%9A%91%E5%81%87%E7%AC%AC%E4%BA%8C%E6%AC%A1%E8%AE%AD%E7%BB%83%E9%A2%98/image-20220712000025404.png" alt="仿真结果" style="zoom:80%;"></p>
<h4 id="7-显示模块程序设计"><a href="#7-显示模块程序设计" class="headerlink" title="(7)  显示模块程序设计"></a>(7)  显示模块程序设计</h4><p>通过串口屏，直接将所得结果进行串口发送后，在上位机对于字符串进行处理，画出幅频特性图，显示电路相关参数，或者显示错误原因。</p>
<h2 id="四、测试方案与测试结果"><a href="#四、测试方案与测试结果" class="headerlink" title="四、测试方案与测试结果"></a>四、测试方案与测试结果</h2><h3 id="表1-基本要求测试结果"><a href="#表1-基本要求测试结果" class="headerlink" title="表1 基本要求测试结果"></a>表1 基本要求测试结果</h3><div class="table-container">
<table>
<thead>
<tr>
<th>测量项目</th>
<th>题目指标</th>
<th>完成情况</th>
<th>是否达标</th>
<th>测试方案简述与测量仪器</th>
</tr>
</thead>
<tbody>
<tr>
<td>电路特性测试仪输出 1kHz 正弦波信号，自动测量并显示该放大器的 输入电阻。</td>
<td>输入电阻测量范围 1kΩ~50kΩ，相对误差的绝对值不超过 10%。</td>
<td></td>
<td></td>
<td>使用搭建系统自动测量。</td>
</tr>
<tr>
<td>电路特性测试仪输出 1kHz 正弦波信号，自动测量并显示该放大器的 输出电阻。</td>
<td>输出电阻测量范围 500Ω~5kΩ，相对误差的绝对值不超过 10%。</td>
<td></td>
<td></td>
<td>使用搭建系统自动测量。</td>
</tr>
<tr>
<td>自动测量并显示该放大器在输入 1kHz 频率时的增益。</td>
<td>相对误差的绝 对值不超过 10%。</td>
<td></td>
<td></td>
<td>使用搭建系统自动测量。</td>
</tr>
<tr>
<td>自动测量并显示该放大器的频幅特性曲线。</td>
<td>显示上限频率值，相对误 差的绝对值不超过 25%。</td>
<td></td>
<td></td>
<td>使用搭建系统自动测量。</td>
</tr>
</tbody>
</table>
</div>
<h3 id="表2-发挥部分测试结果"><a href="#表2-发挥部分测试结果" class="headerlink" title="表2 发挥部分测试结果"></a>表2 发挥部分测试结果</h3><div class="table-container">
<table>
<thead>
<tr>
<th>测量项目</th>
<th>题目指标</th>
<th>完成情况</th>
<th>是否达标</th>
<th>测试方案简述与测量仪器</th>
</tr>
</thead>
<tbody>
<tr>
<td>该电路特性测试仪能判断放大器电路元器件变化而引起故障或变化 的原因。</td>
<td>任意开路或短路 R1~R4 中的一个电阻，电路特性测试仪能 够判断并显示故障原因。</td>
<td></td>
<td></td>
<td>使用搭建系统自动测量。</td>
</tr>
<tr>
<td></td>
<td>任意开路 C1~C3 中的一个电容，电路特性测试仪能够判断并显示故 障原因。</td>
<td></td>
<td></td>
<td>使用搭建系统自动测量。</td>
</tr>
<tr>
<td></td>
<td>任意增大 C1~C3 中的一个电容的容量，使其达到原来值的两倍。电 路特性测试仪能够判断并显示该变化的原因。</td>
<td></td>
<td></td>
<td>使用搭建系统自动测量。</td>
</tr>
<tr>
<td></td>
<td>在判断准确的前提下，提高判断速度，每项判断时间不超过 2 秒。</td>
<td></td>
<td></td>
<td>使用搭建系统自动测量。</td>
</tr>
<tr>
<td>其他。</td>
<td>其他。</td>
<td>未完成</td>
<td>否</td>
<td>无</td>
</tr>
</tbody>
</table>
</div>
<h2 id="五、结论"><a href="#五、结论" class="headerlink" title="五、结论"></a>五、结论</h2><p>在本次训练当中，本组硬件和软件工作总结如下：</p>
<ul>
<li><strong>硬件</strong>：<ul>
<li>通过对于给出待测电路图的仿真，数据分析，总结输入输出特性，故障特点，列出故障清单，方便软件通过电路信息比对获取信息支持。</li>
<li>综合软件限制条件以及电路自身限制，搭建待测元件的外围辅助测量电路。<ul>
<li>搭建信号衰减器使DDS能够给待测电路提供合理的输入电压。</li>
<li>对于待测电路相关重要位置进行结构优化，使用继电器接入采样电阻，配合软件ADC完成对于电路测量工作点的选择。</li>
</ul>
</li>
</ul>
</li>
<li><strong>软件</strong>：<ul>
<li>进行STM32H7系列DSP库的尝试，结合其特点撰写可复用性高的FFT运算模块。</li>
<li>进行系统的总体把握，使用状态机、特殊结构体让系统满足自动化和高内聚，低耦合特点。</li>
<li>使用串口屏等进行外部数据交互的直观显示，并撰写配套代码。</li>
<li>为满足自动化要求，撰写基于DMA定时器同步采样的自动扫频和频谱模值、幅度点选取程序，能够结合FFT获得信号特征。</li>
</ul>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://180.76.50.251/2022/06/04/hello-world/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avator.png">
      <meta itemprop="name" content="MALossov">
      <meta itemprop="description" content="是很菜的人的很菜的博客捏，无栈工程学徒ing。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MAL'S_BLOG">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/06/04/hello-world/" class="post-title-link" itemprop="url">Hello World</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-06-04 06:12:15" itemprop="dateCreated datePublished" datetime="2022-06-04T06:12:15+08:00">2022-06-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-02-18 03:50:41" itemprop="dateModified" datetime="2022-02-18T03:50:41+08:00">2022-02-18</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Welcome to <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a target="_blank" rel="noopener" href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a target="_blank" rel="noopener" href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a target="_blank" rel="noopener" href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>
<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://180.76.50.251/2022/05/17/ProgramLearn/Server/BT-Tomcat-JDK/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avator.png">
      <meta itemprop="name" content="MALossov">
      <meta itemprop="description" content="是很菜的人的很菜的博客捏，无栈工程学徒ing。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MAL'S_BLOG">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/05/17/ProgramLearn/Server/BT-Tomcat-JDK/" class="post-title-link" itemprop="url">配置宝塔桌面，TOMCAT,JDK踩过的一些坑</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-05-17 04:00:53" itemprop="dateCreated datePublished" datetime="2022-05-17T04:00:53+08:00">2022-05-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-05-07 00:21:56" itemprop="dateModified" datetime="2022-05-07T00:21:56+08:00">2022-05-07</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%8E%AF%E5%A2%83/" itemprop="url" rel="index"><span itemprop="name">环境</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="关于JDK"><a href="#关于JDK" class="headerlink" title="关于JDK"></a>关于JDK</h2><p>好用：<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/3e162d5c48f1">ubuntu安装JDK17 - 简书 (jianshu.com)</a>——看来是只能用WGET来做了，操作的目录和这一篇一样都在opt目录下</p>
<h2 id="关于无法启动宝塔"><a href="#关于无法启动宝塔" class="headerlink" title="关于无法启动宝塔"></a>关于无法启动宝塔</h2><ul>
<li>一开始的时候以为是内网防火墙没开8888端口<ul>
<li>于是花老力气去Enable了端口：毕竟人家一开始是inactive的：</li>
<li>其实开不开没有必要，没开就是都能访问，后来还是开了，开的步骤见：<ul>
<li><a target="_blank" rel="noopener" href="http://www.shajuta.com/go/330">virtualbox 上ubuntu 20安装宝塔面板- 防火墙ufw - 沙聚塔 (shajuta.com)</a>——这篇文章都被超烂了，内容也不咋地，将就着看吧</li>
<li>而且发现好像除了ufw之外还有另外一个防火墙命令，不太懂，感觉有点混乱</li>
</ul>
</li>
</ul>
</li>
<li>最后解决的办法是：<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/468126996">腾讯云服务器宝塔面板8888端口放通安全组设置教程 - 知乎 (zhihu.com)</a><ul>
<li>其实是因为内网的安全组没开，但是现在不叫安全组了，直接在服务器里面找：<strong>防火墙</strong>，不过开准入的步骤是一样的</li>
</ul>
</li>
</ul>
<h2 id="关于换源"><a href="#关于换源" class="headerlink" title="关于换源"></a>关于换源</h2><ul>
<li>其实TX都帮你换好了，都是他自己的源，这一点比较良心，具体参考见：<ul>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/142014944">Ubuntu20.04软件源更换 - 知乎 (zhihu.com)</a></li>
</ul>
</li>
</ul>
<h2 id="关于在宝塔上面配置TOMCAT"><a href="#关于在宝塔上面配置TOMCAT" class="headerlink" title="关于在宝塔上面配置TOMCAT"></a>关于在宝塔上面配置TOMCAT</h2><p>其实也没必要依靠宝塔，但是既来之则安之的事情嘛……<br>还没看，太困了，链接我觉得还行的线放这<br>就是思路有些混乱</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_43162161/article/details/105595496">(83条消息) 宝塔配置tomcat<em>天字第零号的博客-CSDN博客</em>宝塔安装tomcat</a>——很顶</li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_51560103/article/details/120027343">(83条消息) 通过宝塔面板部署javaweb项目（个人网站，订单管理系统，阿里云服务器，域名访问，mysql数据库）内容具体详细！_打球唔叻。的博客-CSDN博客</a>——过于详细</li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/anxuanzi/article/details/80400217">(83条消息) 【linux教程】宝塔面板下Tomcat+Nginx部署JAVA WEB应用，超详细！！！！！<em>anxuanzi的博客-CSDN博客</em>宝塔tomcat</a>——比较复杂</li>
<li>在虚拟机中外网也许无法访问到tomcat，于是乎：<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_36935391/article/details/81814505">(85条消息) Tomcat 访问Manager APP报403错误解决方案_飞飞翼的博客-CSDN博客_tomcat403错误</a><ul>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_46017976/article/details/110092801">(85条消息) 进入tomcat manager页面不弹出账号密码框直接401 or 403_Lewis-q398529803的博客-CSDN博客</a></li>
</ul>
</li>
</ul>
<h2 id="关于经常进不去VSCODE的server"><a href="#关于经常进不去VSCODE的server" class="headerlink" title="关于经常进不去VSCODE的server"></a>关于经常进不去VSCODE的server</h2><ul>
<li><a target="_blank" rel="noopener" href="http://www.3fwork.com/kaifa210/002027MYM005560/">[开发工具] vscode ssh连接失败 (3fwork.com)</a></li>
<li>自己不下东西，这个时候，我们直接Kill掉所有带vscode名字的进程就行<ul>
<li>命令为：<code>ps -ef |grep vscode</code></li>
</ul>
</li>
</ul>
<h1 id="更好的TOMCAT配置教程"><a href="#更好的TOMCAT配置教程" class="headerlink" title="更好的TOMCAT配置教程"></a>更好的TOMCAT配置教程</h1><ul>
<li>神文，不解释：<a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1868474">如何在Ubuntu中安装Apache Tomcat - 云+社区 - 腾讯云 (tencent.com)</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://180.76.50.251/2022/04/16/ProgramLearn/Server/UbuntuOnTencentCloud_1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avator.png">
      <meta itemprop="name" content="MALossov">
      <meta itemprop="description" content="是很菜的人的很菜的博客捏，无栈工程学徒ing。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MAL'S_BLOG">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/04/16/ProgramLearn/Server/UbuntuOnTencentCloud_1/" class="post-title-link" itemprop="url">关于拿到了服务器我们应该做什么并且做了什么【1】</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2022-04-16 04:00:53 / Modified: 05:03:13" itemprop="dateCreated datePublished" datetime="2022-04-16T04:00:53+08:00">2022-04-16</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%8E%AF%E5%A2%83/" itemprop="url" rel="index"><span itemprop="name">环境</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="在哪里找到我们的服务器？"><a href="#在哪里找到我们的服务器？" class="headerlink" title="在哪里找到我们的服务器？"></a>在哪里找到我们的服务器？</h2><ul>
<li>一开始我想当然的以为会在<strong>腾讯云控制台</strong>中，但是搜寻一番之后发现结果不尽人意<ul>
<li>后来想想其实我自己用腾讯翻译API的时候也不是在控制台中</li>
<li>经过求助知乎，发现——</li>
</ul>
</li>
<li>可以参考知乎回答：<a target="_blank" rel="noopener" href="https://www.zhihu.com/question/448478892/answer/1771975432">(54 封私信 / 81 条消息) 腾讯云如何查看自己的服务器? - 知乎 (zhihu.com)</a><ul>
<li>但是<strong>这个之乎回答也是坑，虽然能找到，但是需要鼠标和眼睛寻找的地方还是太多</strong></li>
<li>我发现一个更好的方法：（<em>虽然这个方法并不能够推广，仅仅适用于轻量级的服务器</em>）</li>
<li>略微总结即为：直接访问<strong>轻量级</strong>产品控制台：<a target="_blank" rel="noopener" href="https://console.cloud.tencent.com/lighthouse/instance/index">服务器 - 轻量应用服务器 - 控制台 (tencent.com)</a></li>
<li><img src="/2022/04/16/ProgramLearn/Server/UbuntuOnTencentCloud_1/Pasted%20image%2020220416021934.png" alt="Pasted image 20220416021934.png"></li>
<li>将页面拖到底端可以看到我们订单中创建的服务器</li>
</ul>
</li>
</ul>
<h2 id="如何开始食用我们的服务器"><a href="#如何开始食用我们的服务器" class="headerlink" title="如何开始食用我们的服务器"></a>如何开始食用我们的服务器</h2><p><strong>注意：</strong> 由于咱自己玩过<em>树莓派</em> 所以选择了<strong>Ubuntu 20.04LTS</strong>这一派生于  <strong> Debian</strong> 的操作系统，因为比较能够方便的用<code>apt</code>命令来管理软件包，其他操作系统如：<strong>CentOS</strong>等习惯使用<code>yum</code>命令进行管理的发行版无法兼顾，非常抱歉。</p>
<p>开始使用主要需要面对以下两个需求：</p>
<ol>
<li>如何安装好我们需要的软件</li>
<li>如何做好远程管理的准备</li>
</ol>
<p>由于我们首先需要登录，先从第二点开始：</p>
<h2 id="如何做好远程管理的准备"><a href="#如何做好远程管理的准备" class="headerlink" title="如何做好远程管理的准备"></a>如何做好远程管理的准备</h2><hr>
<h3 id="使用ssh登录"><a href="#使用ssh登录" class="headerlink" title="使用ssh登录"></a>使用ssh登录</h3><h4 id="先修改密码"><a href="#先修改密码" class="headerlink" title="先修改密码"></a>先修改密码</h4><ul>
<li>服务器刚在我们手上的时候的密码是不可知的，需要手动设置，我们选择便于使用秘钥登录的<strong>SSH登录</strong>方法</li>
<li>首先配置密码：<ul>
<li>配置密码需要在<strong>远程登录-&gt;VNC</strong>当中进行，页面如下：</li>
<li><img src="/2022/04/16/ProgramLearn/Server/UbuntuOnTencentCloud_1/Pasted%20image%2020220416022801.png" alt="Pasted image 20220416022801.png"></li>
<li>进行重置密码非常简单，按照要求来即可，请一定要记住自己的密码！</li>
</ul>
</li>
<li>接下来进行ssh登录的准备环节，我们首先使用<strong>PowerShell</strong>对于<code>ssh</code>命令进行测试。<ul>
<li>一般情况下Windows自带该命令，如果没有自带可以求助万能的百度<h4 id="再来看ssh"><a href="#再来看ssh" class="headerlink" title="再来看ssh"></a>再来看ssh</h4></li>
</ul>
</li>
<li>使用<code>ssh</code>命令远程登录的命令在一般使用时的 格式为：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh [用户名]@[通道地址] -p [端口号]</span><br></pre></td></tr></table></figure></li>
<li>例如：<code>ssh malossov@192.168.0.4 -p 22</code><ul>
<li>一般情况下，端口号默认为<strong>22</strong>我们不必输入</li>
<li>ubuntu系统的默认用户名应该为：ubuntu<br><strong><em>个人观点：在小组合作时不建议修改和创建更多用户，甚至不建议使用su命令进入root身份。因为这样可能导致不同用户创建的文件其他人无法访问和修改，导致各种奇怪的问题，尤其是需要自己搭建自启动的系统服务的时候。</em></strong></li>
</ul>
</li>
<li>我们输入命令后如果是<strong>win10</strong>等版本自带的<strong>Open-ssh</strong>会提示是否保存对该IP的登录信息，我们选择<code>yes</code>：<img src="/2022/04/16/ProgramLearn/Server/UbuntuOnTencentCloud_1/Pasted%20image%2020220416024000.png" alt="Pasted image 20220416024000.png"></li>
<li>接下来会要求输入密码，输入成功后即可进入系统<ul>
<li><strong><em>注意，SHELL下LINUX输入密码一律不会出现字符显示，输入就完了</em></strong></li>
</ul>
</li>
<li><h5 id="恭喜你-已经学会了SSH！"><a href="#恭喜你-已经学会了SSH！" class="headerlink" title="恭喜你 已经学会了SSH！"></a>恭喜你 已经学会了SSH！</h5></li>
</ul>
<p>当然不可能，我们还需要下一步：配置SSH秘钥来让我们的登录变得方便</p>
<hr>
<h4 id="SSH的秘钥配置"><a href="#SSH的秘钥配置" class="headerlink" title="SSH的秘钥配置"></a>SSH的秘钥配置</h4><h5 id="认识秘钥"><a href="#认识秘钥" class="headerlink" title="认识秘钥"></a>认识秘钥</h5><p>首先按照我的理解两句话介绍一下什么是秘钥以及为什么我们需要秘钥：</p>
<ol>
<li>SSH默认采用的密码很不安全，虽然你记着很难受，但其实破译很容易；</li>
<li>所以如果校验秘钥的话就会方便很多，我们在SSH命令的时候就进行秘钥的校验可以更加安全，也更加快速地连接我们的服务器。<br><strong><em>起码在我的个人经验看来，很多时候都是只允许秘钥登录而不允许密码登录的。当然对我个人而言：更多的是不用输入密码可以偷懒</em></strong></li>
</ol>
<h5 id="生成和配置秘钥"><a href="#生成和配置秘钥" class="headerlink" title="生成和配置秘钥"></a>生成和配置秘钥</h5><p><strong>密钥</strong>分为<strong>公钥</strong>和<strong>私钥</strong>两个部分，而这两个部分的运作过程是：</p>
<ol>
<li><strong>公钥</strong>保存在服务器上，<strong>私钥</strong>保存在个人计算机上。</li>
<li>在ssh时，服务器发来数据，个人计算机用<strong>私钥</strong>进行签名后返回服务器进行验证，一致即可登录<br>从上来看，秘钥一定是成对出现的，而且是通过同一台用户计算机生成的，公钥是用户计算机放到服务器上的。</li>
</ol>
<p>这里因为前面已经登陆过服务器，下面使用用户计算机开始生成秘钥，</p>
<ul>
<li><p>在<strong>PowerShell</strong>中使用命令<code>ssh-keygen</code>生成秘钥，默认使用RSA算法进行加密（<em>膜拜杨神，会自己做RSA加密</em>），如果使用<code>-t</code>参数，则可以指定加密算法。<img src="/2022/04/16/ProgramLearn/Server/UbuntuOnTencentCloud_1/Pasted%20image%2020220416030842.png" alt="Pasted image 20220416030842.png"></p>
<ul>
<li>在所有问题的选项中，其实敲<code>Enter</code>就行，主要是相关文件名称和密码保护的，这里默认就行，需要关注的为：<blockquote>
<p><code>Enter file in which to save the key ((C:\Users\MALossov/.ssh/id_rsa)</code></p>
</blockquote>
</li>
</ul>
</li>
<li><p>这行文字表示我们的秘钥保存的地址为我们的用户下的.ssh文件夹，文件名为id_rsa，如果是使用服务器进行生成可以更好地看清这一过程。</p>
<ul>
<li>我们使用<code>ls -a</code>目录可以看到 <strong>.ssh</strong> 这个隐藏文件夹就在我们的用户目录下（<em>LINUX中~表示用户目录（/home/用户名），而上一条windows宏对应的命令输出为：<code>Enter file in which to save the key (/home/ubuntu/.ssh/id_rsa)</code>）</em>——它是对应我们这个用户的ssh秘钥，接下来进行一波查看<img src="/2022/04/16/ProgramLearn/Server/UbuntuOnTencentCloud_1/Pasted%20image%2020220416025743.png" alt="Pasted image 20220416025743.png"></li>
<li>可以发现<strong>公钥</strong>和<strong>私钥</strong>其实是放在同一文件夹下的</li>
<li>如果有必要可以使用<code>chmod</code>命令修改权限防止他人删除或改动</li>
</ul>
</li>
<li>接下来我们要做的，就是<ul>
<li>让公钥保持在服务器上不动作为校验</li>
<li>把私钥下载到自己的电脑上作为ssh的校验方法<ul>
<li>可以使用<code>scp</code>命令的方法，也可以直接使用<code>cat</code>命令的输出进行复制粘贴。</li>
</ul>
</li>
</ul>
</li>
<li>那么如何配置我们复制下来的私钥作为ssh登陆时使用的私钥呢?</li>
<li><p>我们首先要找到我们本地计算机的ssh配置地址：以<code>Windows11</code>为例，为：<em>C:\Users\[用户名]\.ssh</em>        <img src="/2022/04/16/ProgramLearn/Server/UbuntuOnTencentCloud_1/Pasted%20image%2020220416030448.png" alt="Pasted image 20220416030448.png"></p>
<ul>
<li>在这个文件夹下我们取出公钥并上传到服务器的<strong>~/.ssh/</strong>目录下：文件命名称和内容与本次的公钥内容不一致。<ul>
<li>校验文件的命名默认为：<strong>authorized_keys</strong><ul>
<li>【作废】使用命令进行复制：首先复制本地秘钥的内容，<code>cd</code>进入<strong>.shh</strong> 目录，然后使用<code>echo</code>命令直接写入文件    例：<code>echo [公钥内容] &gt; id_rsa.pub</code></li>
</ul>
</li>
<li>↑这里出现了小小的问题，公钥是分为多行的，所以我们采用另外一种办法，使用Ubuntu内置的编辑器<strong>nano</strong></li>
<li>使用方法很简单：输入命令<code>nano authorized_keys</code></li>
<li>进入编辑窗口，复制粘贴完公钥内容之后<ul>
<li>可以直接使用右键复制粘贴</li>
</ul>
</li>
<li>使用快捷键<code>Ctrl+X</code>退出，按照提示保存修改。</li>
</ul>
</li>
</ul>
</li>
<li><p>接下来测试一下，在<strong>PowerShell</strong>中登出用户，重新登录。</p>
<ul>
<li>发现不用输入密码了，秘钥的配置成功</li>
</ul>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://180.76.50.251/2022/02/23/ProgramLearn/Front/Python/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avator.png">
      <meta itemprop="name" content="MALossov">
      <meta itemprop="description" content="是很菜的人的很菜的博客捏，无栈工程学徒ing。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MAL'S_BLOG">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/02/23/ProgramLearn/Front/Python/" class="post-title-link" itemprop="url">PythonLearning</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2022-02-23 04:00:53 / Modified: 22:29:09" itemprop="dateCreated datePublished" datetime="2022-02-23T04:00:53+08:00">2022-02-23</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%89%8D%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">前端</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="关于Pip"><a href="#关于Pip" class="headerlink" title="关于Pip"></a>关于Pip</h2><ul>
<li>pip的换源：根目录下：<code>～/.pip/pip.conf</code>内容<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[global]</span><br><span class="line">index-url=http://pypi.douban.com/simple</span><br><span class="line">[install]</span><br><span class="line">trusted-host=pypi.douban.com</span><br></pre></td></tr></table></figure>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://180.76.50.251/2022/02/20/ProgramLearn/Raspberry/SystemUSE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avator.png">
      <meta itemprop="name" content="MALossov">
      <meta itemprop="description" content="是很菜的人的很菜的博客捏，无栈工程学徒ing。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MAL'S_BLOG">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/02/20/ProgramLearn/Raspberry/SystemUSE/" class="post-title-link" itemprop="url">树莓派系统基础</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-02-20 18:00:53" itemprop="dateCreated datePublished" datetime="2022-02-20T18:00:53+08:00">2022-02-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-02-22 17:27:34" itemprop="dateModified" datetime="2022-02-22T17:27:34+08:00">2022-02-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%A1%AC%E4%BB%B6/" itemprop="url" rel="index"><span itemprop="name">硬件</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="内存使用情况"><a href="#内存使用情况" class="headerlink" title="内存使用情况"></a>内存使用情况</h2><ul>
<li>查看剩余内存使用情况：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/salesking/p/11109546.html">树莓派查看硬盘空间使用 - 13717607836 - 博客园 (cnblogs.com)</a>———一言以蔽之<code>df -h</code></li>
</ul>
<h2 id="系统版本"><a href="#系统版本" class="headerlink" title="系统版本"></a>系统版本</h2><ul>
<li><a target="_blank" rel="noopener" href="http://bbs.shumeipaiba.com/thread-11-1-1.html">linux版本、内核查询的常用方法 - 综合版块 - 树莓派论坛 - Powered by Discuz! (shumeipaiba.com)</a><ul>
<li>登录到服务器执行 <code>lsb_release -a</code> 即可列出所有版本信息</li>
</ul>
</li>
</ul>
<h2 id="系统的初始化"><a href="#系统的初始化" class="headerlink" title="系统的初始化"></a>系统的初始化</h2><ul>
<li>不推荐：奇巧淫技：<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/e798bf6624aa">树莓派raspberry pi zero w上手笔记 - 简书 (jianshu.com)</a>———用串口通信实属离谱</li>
<li>如何<strong>联网</strong>——推荐：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/syj888/p/11762702.html">树莓派zero 首次连接WiFi网络 - 在路上2019 - 博客园 (cnblogs.com)</a><br>  <strong>注意：在使用系统的时候依旧需要加入空文件ssh，否则容易出事，否则容易出事，否则不启用ssh</strong><ul>
<li>另外：在使用ssh的时候如果已经添加过公钥我的建议是直接删除这个公钥orz，不然容易出事，不然容易出事，不然容易出事……：<a target="_blank" rel="noopener" href="https://blog.csdn.net/wangguchao/article/details/85614914">(135条消息) 问题解决——SSH时出现WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!_口袋里的跳跳糖-CSDN博客</a></li>
</ul>
</li>
</ul>
<h2 id="系统的换源"><a href="#系统的换源" class="headerlink" title="系统的换源"></a>系统的换源</h2><ul>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/98079246">教你如何给树莓派更换软件源 - 知乎 (zhihu.com)</a>———一键更新，非常丝滑。<strong>不过已经落后了，我查出来我们的是11orz</strong><ul>
<li>注意换源前查看raspberrypi的debian版本，一定要对上：<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_35768839/article/details/104751061">(135条消息) 关于Debian发行版本（树莓派系统版本）<em>经济好没有钱的博客-CSDN博客</em>树莓派查看debian版本</a>命令为<code>lsb_release -a</code></li>
</ul>
</li>
<li>真正的教程害得看这个：<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_18275789/article/details/122997715">(135条消息) 树莓派 Raspberry Pi （bullseye）更换阿里云源方法_老鱼干的博客-CSDN博客</a></li>
<li>关于64位（注意要改一下那个啥：改一下<code>buster</code>to<code>bullseye</code>：<a target="_blank" rel="noopener" href="https://blog.csdn.net/baidu_26678247/article/details/108930421">(138条消息) 树莓派4B 64位（arm64）系统配置系统源<em>SWORLD-CSDN博客</em>树莓派arm64</a><br><strong>真实命令：</strong><br>编辑 /etc/apt/sources.list 文件，这里推荐就用系统自带的 nano 命令编辑，命令如下：<br><code>sudo nano /etc/apt/sources.list</code><br>进入编辑界面，删除原有的内容，粘贴如下内容：<blockquote>
<p>deb <a target="_blank" rel="noopener" href="http://mirrors.aliyun.com/raspbian/raspbian/">http://mirrors.aliyun.com/raspbian/raspbian/</a> bullseye  main non-free contrib rpi<br>deb-src <a target="_blank" rel="noopener" href="http://mirrors.aliyun.com/raspbian/raspbian/">http://mirrors.aliyun.com/raspbian/raspbian/</a> bullseye main non-free contrib</p>
</blockquote>
</li>
<li>如果出现<code>unsigned</code>报错的情况，可以通过这篇帖子更新GPG：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/DragonStart/p/8146272.html">解决linux更新apt软件源时报出GPG错误 - asml - 博客园 (cnblogs.com)</a><h2 id="系统的关机"><a href="#系统的关机" class="headerlink" title="系统的关机"></a>系统的关机</h2></li>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/linux/linux-comm-halt.html">Linux halt命令 | 菜鸟教程 (runoob.com)</a></li>
<li><code>halt</code></li>
</ul>
<h2 id="设置系统wifi的方法"><a href="#设置系统wifi的方法" class="headerlink" title="设置系统wifi的方法"></a>设置系统wifi的方法</h2><ul>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/136463580">设置树莓派wifi的几种方式 - 知乎 (zhihu.com)</a>———单个wifi的多种方式</li>
<li>多个wifi:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">ctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev</span><br><span class="line">update_config=1</span><br><span class="line"></span><br><span class="line">network=&#123;</span><br><span class="line"> ssid=<span class="string">&quot;wo_shi_yige_wifi_ssid&quot;</span></span><br><span class="line"> scan_ssid=1</span><br><span class="line"> psk=<span class="string">&quot;wo_shi_mi_ma&quot;</span></span><br><span class="line"> priority=5</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> network=&#123;</span><br><span class="line"> ssid=<span class="string">&quot;pi&quot;</span></span><br><span class="line"> psk=<span class="string">&quot;onlyforpi&quot;</span></span><br><span class="line"> priority=1</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="系统监视"><a href="#系统监视" class="headerlink" title="系统监视"></a>系统监视</h2><ul>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/xingqingly/article/details/104328570">(136条消息) 树莓派监控CPU负载，温度，内存和网络的工具htop和speedometer和s-tui_嵌入式技术在路上-CSDN博客_htop显示温度</a><ul>
<li>我采用的是<code>speedometer</code>启动命令为：<code>speedometer -r eth0 -t eth0</code>和<code>speedometer -r wlan0 -t wlan0</code></li>
</ul>
</li>
</ul>
<h2 id="免密码登录"><a href="#免密码登录" class="headerlink" title="免密码登录"></a>免密码登录</h2><ul>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/u014661152/article/details/109337818">(136条消息) vscode使用ssh密匙远程登录ssh，避免每次登录都输入密码_u014661152的博客-CSDN博客_vscode记住ssh远程密码</a><ul>
<li>主要内容就是俩密钥orz</li>
<li><a target="_blank" rel="noopener" href="https://blog.songjiahao.com/archives/262">VS Code使用ssh密钥连接linux – SAquariusの梦想屋 (songjiahao.com)</a></li>
<li><strong>备注：目前没成功</strong></li>
</ul>
</li>
</ul>
<h2 id="修改树莓派的主机名："><a href="#修改树莓派的主机名：" class="headerlink" title="修改树莓派的主机名："></a>修改树莓派的主机名：</h2><p><a target="_blank" rel="noopener" href="https://shumeipai.nxez.com/2019/02/27/how-to-change-the-hostname-of-your-raspberry-pi.html">如何修改树莓派的主机名 | 树莓派实验室 (nxez.com)</a></p>
<h2 id="树莓派的清除缓存"><a href="#树莓派的清除缓存" class="headerlink" title="树莓派的清除缓存"></a>树莓派的清除缓存</h2><ul>
<li><a target="_blank" rel="noopener" href="https://shumeipai.nxez.com/2017/12/18/how-to-modify-raspberry-pi-swap-partition.html">修改树莓派交换分区 SWAP 的正确姿势 | 树莓派实验室 (nxez.com)</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/pc-boke/articles/10213695.html">Linux释放cache和buffer内存空间 - 腾飞的鹰 - 博客园 (cnblogs.com)</a></li>
</ul>
<h2 id="树莓派写脚本"><a href="#树莓派写脚本" class="headerlink" title="树莓派写脚本"></a>树莓派写脚本</h2><ul>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/yinheyi/p/6648242.html">linux下的shell脚本（基本） - 殷大侠 - 博客园 (cnblogs.com)</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://180.76.50.251/2022/02/20/ProgramLearn/Raspberry/rc.local%E9%97%AE%E9%A2%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avator.png">
      <meta itemprop="name" content="MALossov">
      <meta itemprop="description" content="是很菜的人的很菜的博客捏，无栈工程学徒ing。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MAL'S_BLOG">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/02/20/ProgramLearn/Raspberry/rc.local%E9%97%AE%E9%A2%98/" class="post-title-link" itemprop="url">树莓派自启动问题</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-02-20 18:00:53" itemprop="dateCreated datePublished" datetime="2022-02-20T18:00:53+08:00">2022-02-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-03-04 19:14:42" itemprop="dateModified" datetime="2022-03-04T19:14:42+08:00">2022-03-04</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%A1%AC%E4%BB%B6/" itemprop="url" rel="index"><span itemprop="name">硬件</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="关于-etc-rc-local"><a href="#关于-etc-rc-local" class="headerlink" title="关于/etc/rc.local"></a>关于<strong>/etc/rc.local</strong></h2><ul>
<li>该文件为Linux下的系统启动文件。根据各种博客的总结，该文件的启动为：<strong>联网之后运行命令</strong>，并且在进入系统之后停止。</li>
<li>刚开始搜索时的发现为：可以通过这些运行代码<ul>
<li>其实可以不完全执行完，每条命令之后加<code>&amp;</code>即可。</li>
</ul>
</li>
</ul>
<h3 id="问题的出现："><a href="#问题的出现：" class="headerlink" title="问题的出现："></a>问题的出现：</h3><ul>
<li>由于引用了其他的<strong>bash</strong>脚本，而原本该程序运行的环境为<strong>sh</strong><ul>
<li>所有的报错和问题和这篇如出一辙，放上来：<a target="_blank" rel="noopener" href="https://www.codenong.com/45776003/">关于bash：修复systemd服务203 / EXEC失败(没有这样的文件或目录) | 码农家园 (codenong.com)</a></li>
<li>其他不对应的还有：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/xmfdsh/p/4469577.html">Linux树莓派中/etc/rc.local不执行的问题 - 晓镜水月 - 博客园 (cnblogs.com)</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/liuwinner/article/details/91040565">(138条消息) Linux自启动脚本及解决rc.local不执行脚本问题<em>社会我大姐，人狠胸不大（^</em>^）-CSDN博客_rc.local不执行</a><h3 id="查询服务的状态："><a href="#查询服务的状态：" class="headerlink" title="查询服务的状态："></a>查询服务的状态：</h3></li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/codeit/p/14489491.html">树莓派/etc/rc.local开机启动不执行 - 盛世芳华 - 博客园 (cnblogs.com)</a><ul>
<li>即：<code>sudo systemctl status rc-local</code></li>
</ul>
</li>
</ul>
<h3 id="进程的保活"><a href="#进程的保活" class="headerlink" title="进程的保活"></a>进程的保活</h3><ul>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/linux/linux-comm-nohup.html#:~:text=Linux%20nohup%20%E5%91%BD%E4%BB%A4.%20Linux%20%E5%91%BD%E4%BB%A4%E5%A4%A7%E5%85%A8.%20nohup%20%E8%8B%B1%E6%96%87%E5%85%A8%E7%A7%B0%20no,nohup%20%E5%91%BD%E4%BB%A4%EF%BC%8C%E5%9C%A8%E9%BB%98%E8%AE%A4%E6%83%85%E5%86%B5%E4%B8%8B%EF%BC%88%E9%9D%9E%E9%87%8D%E5%AE%9A%E5%90%91%E6%97%B6%EF%BC%89%EF%BC%8C%E4%BC%9A%E8%BE%93%E5%87%BA%E4%B8%80%E4%B8%AA%E5%90%8D%E5%8F%AB%20nohup.out%20%E7%9A%84%E6%96%87%E4%BB%B6%E5%88%B0%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95%E4%B8%8B%EF%BC%8C%E5%A6%82%E6%9E%9C%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95%E7%9A%84%20nohup.out%20%E6%96%87%E4%BB%B6%E4%B8%8D%E5%8F%AF%E5%86%99%EF%BC%8C%E8%BE%93%E5%87%BA%E9%87%8D%E5%AE%9A%E5%90%91%E5%88%B0%20%24HOME%2Fnohup.out%20%E6%96%87%E4%BB%B6%E4%B8%AD%E3%80%82.">Linux nohup 命令 | 菜鸟教程 (runoob.com)</a><ul>
<li>概括一下：<code>nohup Command [ Arg … ] [　&amp; ]</code></li>
<li>进行一个删除：如果要停止运行，你需要使用以下命令查找到 nohup 运行脚本到 PID，然后使用 kill 命令来删除：<code>ps -aux | grep &quot;runoob.sh&quot;</code></li>
</ul>
</li>
</ul>
<h3 id="开机进程的注册："><a href="#开机进程的注册：" class="headerlink" title="开机进程的注册："></a>开机进程的注册：</h3><p>-<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/93b6a62a8922">ubuntu20.04利用systemctl命令实现开机自启服务 - 简书 (jianshu.com)</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://180.76.50.251/2022/02/19/ProgramLearn/ComputerCommonSenses/Git_helper/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avator.png">
      <meta itemprop="name" content="MALossov">
      <meta itemprop="description" content="是很菜的人的很菜的博客捏，无栈工程学徒ing。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MAL'S_BLOG">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/02/19/ProgramLearn/ComputerCommonSenses/Git_helper/" class="post-title-link" itemprop="url">Linux的软件源</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2022-02-19 19:00:53 / Modified: 19:49:42" itemprop="dateCreated datePublished" datetime="2022-02-19T19:00:53+08:00">2022-02-19</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="基本的全局设置"><a href="#基本的全局设置" class="headerlink" title="基本的全局设置"></a>基本的全局设置</h2><ul>
<li><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_34802511/article/details/90055273">(135条消息) git—-全局设置用户名、密码、邮箱_qq_34802511的博客-CSDN博客_git设置用户名和密码</a></p>
<ul>
<li>无法查看的原因和解决：<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_30588827/article/details/95389491">(135条消息) window上git bash运行错误记录_weixin_30588827的博客-CSDN博客</a></li>
</ul>
</li>
<li><p>解决无法连接github的问题：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/Archer314/p/14641310.html">解决ssh: connect to host github.com port 22: Connection refused - Biile - 博客园 (cnblogs.com)</a></li>
</ul>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://180.76.50.251/2022/02/19/ProgramLearn/Embed/I2s/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avator.png">
      <meta itemprop="name" content="MALossov">
      <meta itemprop="description" content="是很菜的人的很菜的博客捏，无栈工程学徒ing。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MAL'S_BLOG">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/02/19/ProgramLearn/Embed/I2s/" class="post-title-link" itemprop="url">STM32的I2S总线问题（未解决）</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-02-19 04:00:53" itemprop="dateCreated datePublished" datetime="2022-02-19T04:00:53+08:00">2022-02-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-02-20 01:18:28" itemprop="dateModified" datetime="2022-02-20T01:18:28+08:00">2022-02-20</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%A1%AC%E4%BB%B6/" itemprop="url" rel="index"><span itemprop="name">硬件</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <ul>
<li>关于I2S的接线问题：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/firege/p/5805977.html">第38章 I2S—音频播放与录音输入—零死角玩转STM32-F429系列 - 野火_firege - 博客园 (cnblogs.com)</a><ul>
<li>以PCM1808接STM32F103RCT6的I2S2为例：<ul>
<li>DOUT→SD（(Serial Data)：串行数据线，用于发送或接收两个时分复用的数据通道上的数据(仅半双工模式)，如果是全双工模式，该信号仅用于发送数据。）→PB15</li>
<li>LRCK→ WS(Word Select)：字段选择线，也称帧时钟(LRC)线，表明当前传输数据的声道，不同标准有不同的定义。WS线的频率等于采样频率(FS)。→PB12</li>
<li>SCK/BCK→CK(Serial Clock)：串行时钟线，也称位时钟(BCLK)，数字音频的每一位数据都对应有一个CK脉冲，它的频率为：2<em>采样频率</em>量化位数，2代表左右两个通道数据。→PB13</li>
</ul>
</li>
</ul>
</li>
<li>另外还有： ext_SD(extend Serial Data)：扩展串行数据线，用于全双工传输的数据接收。→PB14</li>
<li>更多详情见图：![[Pasted image 20220216175041.png]]</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://180.76.50.251/2022/02/19/ProgramLearn/Embed/OpenOCD/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avator.png">
      <meta itemprop="name" content="MALossov">
      <meta itemprop="description" content="是很菜的人的很菜的博客捏，无栈工程学徒ing。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MAL'S_BLOG">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/02/19/ProgramLearn/Embed/OpenOCD/" class="post-title-link" itemprop="url">Clion中OpenOCD的配置（待补充）</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-02-19 04:00:53" itemprop="dateCreated datePublished" datetime="2022-02-19T04:00:53+08:00">2022-02-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-02-20 01:27:41" itemprop="dateModified" datetime="2022-02-20T01:27:41+08:00">2022-02-20</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%A1%AC%E4%BB%B6/" itemprop="url" rel="index"><span itemprop="name">硬件</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><strong>非常重要</strong>！：自己修改之后一定记得改这个不然肯定要出错！<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_43715171/article/details/118826584">(133条消息) Clion配置STM32开发环境踩坑_FILWY_M的博客-CSDN博客</a><br><strong>关于最后成功使用OpenOCD的一些个人理解</strong>：所有的连接器配置在<code>/script/target</code>里面，所有的板子的配置在<code>/script/board/</code>里面我们要做的就是把类似于<em>stm32-discovery-f3</em>里面的东西给复制下来改成我们自己需要的。<br>毕竟这玩意里面find一层套一层的，我这种笨比基本上是顶不住的。</p>
<h2 id="总之要在Board里面新建点东西，就是这样捏"><a href="#总之要在Board里面新建点东西，就是这样捏" class="headerlink" title="总之要在Board里面新建点东西，就是这样捏"></a>总之要在Board里面新建点东西，就是这样捏</h2>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="MALossov"
      src="/uploads/avator.png">
  <p class="site-author-name" itemprop="name">MALossov</p>
  <div class="site-description" itemprop="description">是很菜的人的很菜的博客捏，无栈工程学徒ing。</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">30</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">25</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/malossov" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;malossov" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.zhihu.com/people/yi-wan-nzlao-si-ji" title="知乎 → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;yi-wan-nzlao-si-ji" rel="noopener" target="_blank"><i class="fab fa-zhihu fa-fw"></i>知乎</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://gitee.com/malossov" title="Gitee → https:&#x2F;&#x2F;gitee.com&#x2F;malossov" rel="noopener" target="_blank"><i class="fab fa-gitee fa-fw"></i>Gitee</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">MALossov</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>


  <script defer src="/lib/three/three.min.js"></script>
    <script defer src="/lib/three/three-waves.min.js"></script>


  















  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
          load: ['[tex]/mhchem'],
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
          packages: {'[+]': ['mhchem']},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  


<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/src/love.js"></script>
<!-- 背景动画 -->
<script type="text/javascript" src="/js/src/particle.js"></script>


</body>
</html>
